2024/04/11 10:01:03 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/11 10:01:03 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-11 10:01:03,931][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-11 10:01:03,936][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-11 10:01:03,937][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-11 10:01:03,937][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/11 10:01:03 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
[2024-04-11 10:01:03,949][pytorch_lightning.utilities.rank_zero][INFO] - You are using a CUDA device ('NVIDIA GeForce RTX 4090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/utilities/model_summary/model_summary.py:454: A layer with UninitializedParameter was found. Thus, the total number of parameters detected may be inaccurate.

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.193
[2024-04-11 10:01:27,329][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 30: 'val_loss' reached 0.19271 (best 0.19271), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
Metric val_loss improved by 0.038 >= min_delta = 1e-05. New best score: 0.154
[2024-04-11 10:01:45,142][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 60: 'val_loss' reached 0.15449 (best 0.15449), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
Metric val_loss improved by 0.020 >= min_delta = 1e-05. New best score: 0.134
[2024-04-11 10:02:02,154][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 90: 'val_loss' reached 0.13405 (best 0.13405), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.128
[2024-04-11 10:02:19,338][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 120: 'val_loss' reached 0.12788 (best 0.12788), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.120
[2024-04-11 10:02:36,592][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 150: 'val_loss' reached 0.12013 (best 0.12013), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
Metric val_loss improved by 0.010 >= min_delta = 1e-05. New best score: 0.111
[2024-04-11 10:02:54,152][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 180: 'val_loss' reached 0.11057 (best 0.11057), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
[2024-04-11 10:03:12,065][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 210: 'val_loss' was not in top 1
Metric val_loss improved by 0.012 >= min_delta = 1e-05. New best score: 0.099
[2024-04-11 10:03:29,610][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 240: 'val_loss' reached 0.09855 (best 0.09855), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.090
[2024-04-11 10:03:47,182][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 270: 'val_loss' reached 0.09035 (best 0.09035), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
[2024-04-11 10:04:05,341][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 300: 'val_loss' was not in top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.085
[2024-04-11 10:04:22,750][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 330: 'val_loss' reached 0.08533 (best 0.08533), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.083
[2024-04-11 10:04:39,902][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 360: 'val_loss' reached 0.08320 (best 0.08320), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
[2024-04-11 10:04:57,251][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 390: 'val_loss' was not in top 1
[2024-04-11 10:05:14,488][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 420: 'val_loss' was not in top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.074
[2024-04-11 10:05:32,208][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 450: 'val_loss' reached 0.07410 (best 0.07410), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.071
[2024-04-11 10:05:49,756][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 480: 'val_loss' reached 0.07133 (best 0.07133), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.068
[2024-04-11 10:06:06,945][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 510: 'val_loss' reached 0.06839 (best 0.06839), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
[2024-04-11 10:06:24,549][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 540: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.068
[2024-04-11 10:06:42,023][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 570: 'val_loss' reached 0.06769 (best 0.06769), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.063
[2024-04-11 10:06:59,362][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 600: 'val_loss' reached 0.06320 (best 0.06320), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
[2024-04-11 10:07:17,061][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 630: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.061
[2024-04-11 10:07:34,108][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 660: 'val_loss' reached 0.06104 (best 0.06104), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
[2024-04-11 10:07:51,485][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 690: 'val_loss' was not in top 1
[2024-04-11 10:08:09,284][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 720: 'val_loss' was not in top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.053
[2024-04-11 10:08:26,261][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 750: 'val_loss' reached 0.05323 (best 0.05323), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.053
[2024-04-11 10:08:43,628][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 780: 'val_loss' reached 0.05252 (best 0.05252), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
[2024-04-11 10:09:01,745][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 810: 'val_loss' was not in top 1
[2024-04-11 10:09:18,461][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 840: 'val_loss' was not in top 1
[2024-04-11 10:09:35,852][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 870: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.051
[2024-04-11 10:09:53,352][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 900: 'val_loss' reached 0.05119 (best 0.05119), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
[2024-04-11 10:10:11,028][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 930: 'val_loss' was not in top 1
[2024-04-11 10:10:28,364][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 960: 'val_loss' was not in top 1
[2024-04-11 10:10:45,715][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 990: 'val_loss' was not in top 1
[2024-04-11 10:11:03,373][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1020: 'val_loss' was not in top 1
[2024-04-11 10:11:20,611][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1050: 'val_loss' was not in top 1
[2024-04-11 10:11:38,120][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 1080: 'val_loss' was not in top 1
[2024-04-11 10:11:55,067][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 1110: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.050
[2024-04-11 10:12:12,170][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 1140: 'val_loss' reached 0.04979 (best 0.04979), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.046
[2024-04-11 10:12:29,526][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 1170: 'val_loss' reached 0.04625 (best 0.04625), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.046
[2024-04-11 10:12:47,110][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 1200: 'val_loss' reached 0.04616 (best 0.04616), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
[2024-04-11 10:13:04,190][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 1230: 'val_loss' was not in top 1
[2024-04-11 10:13:21,880][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 1260: 'val_loss' was not in top 1
[2024-04-11 10:13:39,497][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 1290: 'val_loss' was not in top 1
[2024-04-11 10:13:57,416][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 1320: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.044
[2024-04-11 10:14:15,313][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 1350: 'val_loss' reached 0.04361 (best 0.04361), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
[2024-04-11 10:14:32,968][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 1380: 'val_loss' was not in top 1
[2024-04-11 10:14:50,642][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 1410: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.041
[2024-04-11 10:15:07,832][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 1440: 'val_loss' reached 0.04062 (best 0.04062), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
[2024-04-11 10:15:25,588][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 1470: 'val_loss' was not in top 1
[2024-04-11 10:15:43,097][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 1500: 'val_loss' was not in top 1
[2024-04-11 10:16:00,035][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 50, global step 1530: 'val_loss' was not in top 1
[2024-04-11 10:16:17,549][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 51, global step 1560: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.038
[2024-04-11 10:16:34,698][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 52, global step 1590: 'val_loss' reached 0.03783 (best 0.03783), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
[2024-04-11 10:16:52,567][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 53, global step 1620: 'val_loss' was not in top 1
[2024-04-11 10:17:10,268][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 54, global step 1650: 'val_loss' was not in top 1
[2024-04-11 10:17:27,321][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 55, global step 1680: 'val_loss' was not in top 1
[2024-04-11 10:17:44,815][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 56, global step 1710: 'val_loss' was not in top 1
[2024-04-11 10:18:02,300][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 57, global step 1740: 'val_loss' was not in top 1
[2024-04-11 10:18:19,592][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 58, global step 1770: 'val_loss' was not in top 1
[2024-04-11 10:18:37,087][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 59, global step 1800: 'val_loss' was not in top 1
[2024-04-11 10:18:54,862][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 60, global step 1830: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.034
[2024-04-11 10:19:12,615][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 61, global step 1860: 'val_loss' reached 0.03428 (best 0.03428), saving model to '/tmp/tmpn__naepb/model_0.ckpt' as top 1
[2024-04-11 10:19:29,603][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 62, global step 1890: 'val_loss' was not in top 1
[2024-04-11 10:19:47,492][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 63, global step 1920: 'val_loss' was not in top 1
[2024-04-11 10:20:05,222][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 64, global step 1950: 'val_loss' was not in top 1
[2024-04-11 10:20:22,343][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 65, global step 1980: 'val_loss' was not in top 1
[2024-04-11 10:20:39,771][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 66, global step 2010: 'val_loss' was not in top 1
[2024-04-11 10:20:57,134][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 67, global step 2040: 'val_loss' was not in top 1
[2024-04-11 10:21:14,411][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 68, global step 2070: 'val_loss' was not in top 1
[2024-04-11 10:21:31,828][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 69, global step 2100: 'val_loss' was not in top 1
[2024-04-11 10:21:49,356][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 70, global step 2130: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.034. Signaling Trainer to stop.
[2024-04-11 10:22:06,901][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 71, global step 2160: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
2024/04/11 10:22:09 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/11 10:22:09 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/11 10:22:09 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/11 10:22:09 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-11 10:22:09,858][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-11 10:22:09,858][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-11 10:22:09,858][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-11 10:22:09,858][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/11 10:22:09 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpn__naepb exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.192
[2024-04-11 10:22:31,827][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 30: 'val_loss' reached 0.19243 (best 0.19243), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.039 >= min_delta = 1e-05. New best score: 0.154
[2024-04-11 10:22:49,040][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 60: 'val_loss' reached 0.15358 (best 0.15358), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.012 >= min_delta = 1e-05. New best score: 0.141
[2024-04-11 10:23:06,464][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 90: 'val_loss' reached 0.14129 (best 0.14129), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.015 >= min_delta = 1e-05. New best score: 0.126
[2024-04-11 10:23:24,232][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 120: 'val_loss' reached 0.12616 (best 0.12616), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.117
[2024-04-11 10:23:41,913][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 150: 'val_loss' reached 0.11718 (best 0.11718), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.012 >= min_delta = 1e-05. New best score: 0.105
[2024-04-11 10:24:00,082][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 180: 'val_loss' reached 0.10502 (best 0.10502), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
[2024-04-11 10:24:17,112][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 210: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.102
[2024-04-11 10:24:34,441][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 240: 'val_loss' reached 0.10211 (best 0.10211), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.093
[2024-04-11 10:24:52,099][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 270: 'val_loss' reached 0.09347 (best 0.09347), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.087
[2024-04-11 10:25:10,144][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 300: 'val_loss' reached 0.08704 (best 0.08704), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.086
[2024-04-11 10:25:27,910][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 330: 'val_loss' reached 0.08615 (best 0.08615), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.083
[2024-04-11 10:25:45,803][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 360: 'val_loss' reached 0.08326 (best 0.08326), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.081
[2024-04-11 10:26:03,497][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 390: 'val_loss' reached 0.08059 (best 0.08059), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.078
[2024-04-11 10:26:20,938][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 420: 'val_loss' reached 0.07782 (best 0.07782), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.071
[2024-04-11 10:26:38,822][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 450: 'val_loss' reached 0.07140 (best 0.07140), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.066
[2024-04-11 10:26:56,556][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 480: 'val_loss' reached 0.06607 (best 0.06607), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
[2024-04-11 10:27:14,173][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 510: 'val_loss' was not in top 1
[2024-04-11 10:27:32,341][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 540: 'val_loss' was not in top 1
[2024-04-11 10:27:50,785][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 570: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.064
[2024-04-11 10:28:08,947][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 600: 'val_loss' reached 0.06437 (best 0.06437), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.058
[2024-04-11 10:28:26,966][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 630: 'val_loss' reached 0.05844 (best 0.05844), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
[2024-04-11 10:28:43,903][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 660: 'val_loss' was not in top 1
[2024-04-11 10:29:01,796][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 690: 'val_loss' was not in top 1
[2024-04-11 10:29:19,347][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 720: 'val_loss' was not in top 1
[2024-04-11 10:29:37,233][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 750: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.058
[2024-04-11 10:29:55,247][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 780: 'val_loss' reached 0.05811 (best 0.05811), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.052
[2024-04-11 10:30:13,370][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 810: 'val_loss' reached 0.05190 (best 0.05190), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
[2024-04-11 10:30:31,050][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 840: 'val_loss' was not in top 1
[2024-04-11 10:30:48,348][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 870: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.048
[2024-04-11 10:31:05,723][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 900: 'val_loss' reached 0.04751 (best 0.04751), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
[2024-04-11 10:31:23,672][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 930: 'val_loss' was not in top 1
[2024-04-11 10:31:40,760][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 960: 'val_loss' was not in top 1
[2024-04-11 10:31:58,492][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 990: 'val_loss' was not in top 1
[2024-04-11 10:32:16,177][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1020: 'val_loss' was not in top 1
[2024-04-11 10:32:33,672][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1050: 'val_loss' was not in top 1
[2024-04-11 10:32:51,589][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 1080: 'val_loss' was not in top 1
[2024-04-11 10:33:08,887][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 1110: 'val_loss' was not in top 1
[2024-04-11 10:33:26,537][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 1140: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.047
[2024-04-11 10:33:44,508][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 1170: 'val_loss' reached 0.04663 (best 0.04663), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.046
[2024-04-11 10:34:01,340][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 1200: 'val_loss' reached 0.04579 (best 0.04579), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.045
[2024-04-11 10:34:18,513][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 1230: 'val_loss' reached 0.04485 (best 0.04485), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.042
[2024-04-11 10:34:35,833][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 1260: 'val_loss' reached 0.04165 (best 0.04165), saving model to '/tmp/tmpn__naepb/model_1.ckpt' as top 1
[2024-04-11 10:34:52,887][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 1290: 'val_loss' was not in top 1
[2024-04-11 10:35:10,619][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 1320: 'val_loss' was not in top 1
[2024-04-11 10:35:28,422][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 1350: 'val_loss' was not in top 1
[2024-04-11 10:35:46,504][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 1380: 'val_loss' was not in top 1
[2024-04-11 10:36:04,191][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 1410: 'val_loss' was not in top 1
[2024-04-11 10:36:21,673][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 1440: 'val_loss' was not in top 1
[2024-04-11 10:36:39,174][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 1470: 'val_loss' was not in top 1
[2024-04-11 10:36:56,985][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 1500: 'val_loss' was not in top 1
[2024-04-11 10:37:14,043][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 50, global step 1530: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.042. Signaling Trainer to stop.
[2024-04-11 10:37:31,985][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 51, global step 1560: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/11 10:37:34 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/11 10:37:34 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/11 10:37:34 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/11 10:37:34 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-11 10:37:34,613][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-11 10:37:34,613][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-11 10:37:34,613][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-11 10:37:34,613][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/11 10:37:34 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpn__naepb exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.199
[2024-04-11 10:37:57,622][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 30: 'val_loss' reached 0.19917 (best 0.19917), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.043 >= min_delta = 1e-05. New best score: 0.156
[2024-04-11 10:38:14,760][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 60: 'val_loss' reached 0.15621 (best 0.15621), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.016 >= min_delta = 1e-05. New best score: 0.140
[2024-04-11 10:38:32,379][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 90: 'val_loss' reached 0.14046 (best 0.14046), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.015 >= min_delta = 1e-05. New best score: 0.125
[2024-04-11 10:38:49,276][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 120: 'val_loss' reached 0.12517 (best 0.12517), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.123
[2024-04-11 10:39:06,671][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 150: 'val_loss' reached 0.12333 (best 0.12333), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.010 >= min_delta = 1e-05. New best score: 0.113
[2024-04-11 10:39:24,516][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 180: 'val_loss' reached 0.11326 (best 0.11326), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.104
[2024-04-11 10:39:42,151][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 210: 'val_loss' reached 0.10417 (best 0.10417), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.011 >= min_delta = 1e-05. New best score: 0.094
[2024-04-11 10:39:59,933][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 240: 'val_loss' reached 0.09364 (best 0.09364), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
[2024-04-11 10:40:17,878][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 270: 'val_loss' was not in top 1
[2024-04-11 10:40:35,048][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 300: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.092
[2024-04-11 10:40:52,765][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 330: 'val_loss' reached 0.09206 (best 0.09206), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.087
[2024-04-11 10:41:10,711][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 360: 'val_loss' reached 0.08650 (best 0.08650), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.079
[2024-04-11 10:41:27,915][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 390: 'val_loss' reached 0.07869 (best 0.07869), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.077
[2024-04-11 10:41:45,410][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 420: 'val_loss' reached 0.07723 (best 0.07723), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.075
[2024-04-11 10:42:02,648][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 450: 'val_loss' reached 0.07456 (best 0.07456), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.073
[2024-04-11 10:42:20,435][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 480: 'val_loss' reached 0.07296 (best 0.07296), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.007 >= min_delta = 1e-05. New best score: 0.066
[2024-04-11 10:42:37,528][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 510: 'val_loss' reached 0.06643 (best 0.06643), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
[2024-04-11 10:42:54,716][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 540: 'val_loss' was not in top 1
[2024-04-11 10:43:12,369][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 570: 'val_loss' was not in top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.060
[2024-04-11 10:43:29,626][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 600: 'val_loss' reached 0.06027 (best 0.06027), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
[2024-04-11 10:43:47,534][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 630: 'val_loss' was not in top 1
[2024-04-11 10:44:04,888][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 660: 'val_loss' was not in top 1
[2024-04-11 10:44:22,585][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 690: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.059
[2024-04-11 10:44:39,853][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 720: 'val_loss' reached 0.05898 (best 0.05898), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
[2024-04-11 10:44:57,613][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 750: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.056
[2024-04-11 10:45:15,589][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 780: 'val_loss' reached 0.05565 (best 0.05565), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.053
[2024-04-11 10:45:33,410][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 810: 'val_loss' reached 0.05298 (best 0.05298), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
[2024-04-11 10:45:51,326][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 840: 'val_loss' was not in top 1
[2024-04-11 10:46:09,308][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 870: 'val_loss' was not in top 1
[2024-04-11 10:46:26,846][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 900: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.052
[2024-04-11 10:46:44,662][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 930: 'val_loss' reached 0.05183 (best 0.05183), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.050
[2024-04-11 10:47:01,585][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 960: 'val_loss' reached 0.04975 (best 0.04975), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
[2024-04-11 10:47:19,349][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 990: 'val_loss' was not in top 1
[2024-04-11 10:47:36,805][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1020: 'val_loss' was not in top 1
[2024-04-11 10:47:54,040][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1050: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.047
[2024-04-11 10:48:11,898][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 1080: 'val_loss' reached 0.04684 (best 0.04684), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
[2024-04-11 10:48:29,829][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 1110: 'val_loss' was not in top 1
[2024-04-11 10:48:46,987][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 1140: 'val_loss' was not in top 1
[2024-04-11 10:49:04,329][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 1170: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.043
[2024-04-11 10:49:21,668][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 1200: 'val_loss' reached 0.04333 (best 0.04333), saving model to '/tmp/tmpn__naepb/model_2.ckpt' as top 1
[2024-04-11 10:49:38,759][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 1230: 'val_loss' was not in top 1
[2024-04-11 10:49:56,708][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 1260: 'val_loss' was not in top 1
[2024-04-11 10:50:14,593][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 1290: 'val_loss' was not in top 1
[2024-04-11 10:50:31,523][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 1320: 'val_loss' was not in top 1
[2024-04-11 10:50:48,849][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 1350: 'val_loss' was not in top 1
[2024-04-11 10:51:06,344][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 1380: 'val_loss' was not in top 1
[2024-04-11 10:51:23,852][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 1410: 'val_loss' was not in top 1
[2024-04-11 10:51:41,424][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 1440: 'val_loss' was not in top 1
[2024-04-11 10:51:58,827][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 1470: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.043. Signaling Trainer to stop.
[2024-04-11 10:52:16,327][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 1500: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/11 10:52:18 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/11 10:52:18 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/11 10:52:18 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/11 10:52:18 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-11 10:52:18,957][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-11 10:52:18,957][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-11 10:52:18,957][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-11 10:52:18,957][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/11 10:52:18 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpn__naepb exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.199
[2024-04-11 10:52:42,102][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 30: 'val_loss' reached 0.19900 (best 0.19900), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
Metric val_loss improved by 0.051 >= min_delta = 1e-05. New best score: 0.148
[2024-04-11 10:52:59,205][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 60: 'val_loss' reached 0.14820 (best 0.14820), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 10:53:17,204][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 90: 'val_loss' was not in top 1
Metric val_loss improved by 0.015 >= min_delta = 1e-05. New best score: 0.133
[2024-04-11 10:53:34,422][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 120: 'val_loss' reached 0.13296 (best 0.13296), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
Metric val_loss improved by 0.010 >= min_delta = 1e-05. New best score: 0.123
[2024-04-11 10:53:52,188][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 150: 'val_loss' reached 0.12283 (best 0.12283), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.114
[2024-04-11 10:54:09,340][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 180: 'val_loss' reached 0.11352 (best 0.11352), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
Metric val_loss improved by 0.011 >= min_delta = 1e-05. New best score: 0.103
[2024-04-11 10:54:26,784][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 210: 'val_loss' reached 0.10255 (best 0.10255), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.099
[2024-04-11 10:54:44,780][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 240: 'val_loss' reached 0.09900 (best 0.09900), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.093
[2024-04-11 10:55:02,236][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 270: 'val_loss' reached 0.09300 (best 0.09300), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.090
[2024-04-11 10:55:19,501][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 300: 'val_loss' reached 0.09026 (best 0.09026), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 10:55:36,813][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 330: 'val_loss' was not in top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.083
[2024-04-11 10:55:54,102][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 360: 'val_loss' reached 0.08264 (best 0.08264), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 10:56:12,009][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 390: 'val_loss' was not in top 1
Metric val_loss improved by 0.010 >= min_delta = 1e-05. New best score: 0.073
[2024-04-11 10:56:28,837][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 420: 'val_loss' reached 0.07274 (best 0.07274), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.067
[2024-04-11 10:56:46,271][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 450: 'val_loss' reached 0.06672 (best 0.06672), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 10:57:03,305][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 480: 'val_loss' was not in top 1
[2024-04-11 10:57:20,907][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 510: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.065
[2024-04-11 10:57:38,798][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 540: 'val_loss' reached 0.06478 (best 0.06478), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 10:57:56,675][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 570: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.061
[2024-04-11 10:58:13,956][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 600: 'val_loss' reached 0.06093 (best 0.06093), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.060
[2024-04-11 10:58:31,337][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 630: 'val_loss' reached 0.05983 (best 0.05983), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 10:58:49,368][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 660: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.060
[2024-04-11 10:59:07,498][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 690: 'val_loss' reached 0.05969 (best 0.05969), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.054
[2024-04-11 10:59:24,824][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 720: 'val_loss' reached 0.05410 (best 0.05410), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.052
[2024-04-11 10:59:42,035][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 750: 'val_loss' reached 0.05214 (best 0.05214), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 10:59:59,242][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 780: 'val_loss' was not in top 1
[2024-04-11 11:00:17,304][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 810: 'val_loss' was not in top 1
[2024-04-11 11:00:34,431][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 840: 'val_loss' was not in top 1
[2024-04-11 11:00:52,309][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 870: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.051
[2024-04-11 11:01:09,152][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 900: 'val_loss' reached 0.05121 (best 0.05121), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 11:01:27,397][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 930: 'val_loss' was not in top 1
[2024-04-11 11:01:45,506][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 960: 'val_loss' was not in top 1
[2024-04-11 11:02:03,014][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 990: 'val_loss' was not in top 1
[2024-04-11 11:02:20,426][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1020: 'val_loss' was not in top 1
[2024-04-11 11:02:38,188][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1050: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.049
[2024-04-11 11:02:55,084][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 1080: 'val_loss' reached 0.04938 (best 0.04938), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 11:03:12,766][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 1110: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.048
[2024-04-11 11:03:30,489][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 1140: 'val_loss' reached 0.04751 (best 0.04751), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 11:03:48,614][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 1170: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.047
[2024-04-11 11:04:06,619][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 1200: 'val_loss' reached 0.04708 (best 0.04708), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 11:04:24,173][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 1230: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.044
[2024-04-11 11:04:41,729][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 1260: 'val_loss' reached 0.04427 (best 0.04427), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 11:04:59,671][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 1290: 'val_loss' was not in top 1
[2024-04-11 11:05:17,438][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 1320: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.043
[2024-04-11 11:05:35,353][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 1350: 'val_loss' reached 0.04283 (best 0.04283), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 11:05:53,084][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 1380: 'val_loss' was not in top 1
[2024-04-11 11:06:10,738][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 1410: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.041
[2024-04-11 11:06:28,221][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 1440: 'val_loss' reached 0.04088 (best 0.04088), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 11:06:45,724][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 1470: 'val_loss' was not in top 1
[2024-04-11 11:07:02,760][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 1500: 'val_loss' was not in top 1
[2024-04-11 11:07:19,712][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 50, global step 1530: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.040
[2024-04-11 11:07:37,533][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 51, global step 1560: 'val_loss' reached 0.04023 (best 0.04023), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 11:07:55,253][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 52, global step 1590: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.040
[2024-04-11 11:08:12,691][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 53, global step 1620: 'val_loss' reached 0.04001 (best 0.04001), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 11:08:30,029][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 54, global step 1650: 'val_loss' was not in top 1
[2024-04-11 11:08:48,050][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 55, global step 1680: 'val_loss' was not in top 1
[2024-04-11 11:09:06,079][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 56, global step 1710: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.038
[2024-04-11 11:09:23,710][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 57, global step 1740: 'val_loss' reached 0.03810 (best 0.03810), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 11:09:41,561][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 58, global step 1770: 'val_loss' was not in top 1
[2024-04-11 11:09:59,757][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 59, global step 1800: 'val_loss' was not in top 1
[2024-04-11 11:10:17,811][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 60, global step 1830: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.037
[2024-04-11 11:10:35,306][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 61, global step 1860: 'val_loss' reached 0.03712 (best 0.03712), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 11:10:52,517][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 62, global step 1890: 'val_loss' was not in top 1
[2024-04-11 11:11:10,371][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 63, global step 1920: 'val_loss' was not in top 1
[2024-04-11 11:11:28,179][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 64, global step 1950: 'val_loss' was not in top 1
[2024-04-11 11:11:45,394][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 65, global step 1980: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.035
[2024-04-11 11:12:02,901][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 66, global step 2010: 'val_loss' reached 0.03487 (best 0.03487), saving model to '/tmp/tmpn__naepb/model_3.ckpt' as top 1
[2024-04-11 11:12:20,113][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 67, global step 2040: 'val_loss' was not in top 1
[2024-04-11 11:12:38,286][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 68, global step 2070: 'val_loss' was not in top 1
[2024-04-11 11:12:55,909][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 69, global step 2100: 'val_loss' was not in top 1
[2024-04-11 11:13:13,841][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 70, global step 2130: 'val_loss' was not in top 1
[2024-04-11 11:13:31,806][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 71, global step 2160: 'val_loss' was not in top 1
[2024-04-11 11:13:49,865][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 72, global step 2190: 'val_loss' was not in top 1
[2024-04-11 11:14:06,747][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 73, global step 2220: 'val_loss' was not in top 1
[2024-04-11 11:14:24,326][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 74, global step 2250: 'val_loss' was not in top 1
[2024-04-11 11:14:42,323][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 75, global step 2280: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.035. Signaling Trainer to stop.
[2024-04-11 11:14:59,631][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 76, global step 2310: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/11 11:15:02 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/11 11:15:02 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/11 11:15:02 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/11 11:15:02 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-11 11:15:02,412][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-11 11:15:02,412][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-11 11:15:02,412][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-11 11:15:02,412][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/11 11:15:02 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpn__naepb exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.192
[2024-04-11 11:15:25,255][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 30: 'val_loss' reached 0.19191 (best 0.19191), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.035 >= min_delta = 1e-05. New best score: 0.157
[2024-04-11 11:15:42,566][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 60: 'val_loss' reached 0.15722 (best 0.15722), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.017 >= min_delta = 1e-05. New best score: 0.140
[2024-04-11 11:15:59,944][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 90: 'val_loss' reached 0.13998 (best 0.13998), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.134
[2024-04-11 11:16:17,751][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 120: 'val_loss' reached 0.13375 (best 0.13375), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.014 >= min_delta = 1e-05. New best score: 0.120
[2024-04-11 11:16:35,217][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 150: 'val_loss' reached 0.11950 (best 0.11950), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.013 >= min_delta = 1e-05. New best score: 0.107
[2024-04-11 11:16:52,730][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 180: 'val_loss' reached 0.10698 (best 0.10698), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.106
[2024-04-11 11:17:09,819][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 210: 'val_loss' reached 0.10620 (best 0.10620), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.102
[2024-04-11 11:17:27,450][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 240: 'val_loss' reached 0.10185 (best 0.10185), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.099
[2024-04-11 11:17:44,968][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 270: 'val_loss' reached 0.09947 (best 0.09947), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.010 >= min_delta = 1e-05. New best score: 0.089
[2024-04-11 11:18:02,847][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 300: 'val_loss' reached 0.08902 (best 0.08902), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.084
[2024-04-11 11:18:19,972][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 330: 'val_loss' reached 0.08389 (best 0.08389), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:18:37,158][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 360: 'val_loss' was not in top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.076
[2024-04-11 11:18:54,054][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 390: 'val_loss' reached 0.07614 (best 0.07614), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:19:11,180][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 420: 'val_loss' was not in top 1
[2024-04-11 11:19:28,999][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 450: 'val_loss' was not in top 1
[2024-04-11 11:19:46,276][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 480: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.072
[2024-04-11 11:20:03,320][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 510: 'val_loss' reached 0.07226 (best 0.07226), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.068
[2024-04-11 11:20:20,271][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 540: 'val_loss' reached 0.06804 (best 0.06804), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:20:37,666][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 570: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.064
[2024-04-11 11:20:55,167][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 600: 'val_loss' reached 0.06377 (best 0.06377), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.062
[2024-04-11 11:21:12,345][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 630: 'val_loss' reached 0.06243 (best 0.06243), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:21:29,976][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 660: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.058
[2024-04-11 11:21:47,020][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 690: 'val_loss' reached 0.05808 (best 0.05808), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:22:04,998][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 720: 'val_loss' was not in top 1
[2024-04-11 11:22:22,416][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 750: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.057
[2024-04-11 11:22:40,217][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 780: 'val_loss' reached 0.05668 (best 0.05668), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:22:57,899][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 810: 'val_loss' was not in top 1
[2024-04-11 11:23:15,582][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 840: 'val_loss' was not in top 1
[2024-04-11 11:23:32,388][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 870: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.054
[2024-04-11 11:23:49,993][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 900: 'val_loss' reached 0.05384 (best 0.05384), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.052
[2024-04-11 11:24:07,590][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 930: 'val_loss' reached 0.05174 (best 0.05174), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.051
[2024-04-11 11:24:24,676][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 960: 'val_loss' reached 0.05134 (best 0.05134), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.051
[2024-04-11 11:24:41,655][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 990: 'val_loss' reached 0.05074 (best 0.05074), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:24:58,944][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1020: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.049
[2024-04-11 11:25:15,927][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1050: 'val_loss' reached 0.04920 (best 0.04920), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:25:33,141][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 1080: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.047
[2024-04-11 11:25:50,482][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 1110: 'val_loss' reached 0.04725 (best 0.04725), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:26:07,901][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 1140: 'val_loss' was not in top 1
[2024-04-11 11:26:25,024][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 1170: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.047
[2024-04-11 11:26:42,146][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 1200: 'val_loss' reached 0.04724 (best 0.04724), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.042
[2024-04-11 11:26:59,156][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 1230: 'val_loss' reached 0.04248 (best 0.04248), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:27:16,371][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 1260: 'val_loss' was not in top 1
[2024-04-11 11:27:33,729][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 1290: 'val_loss' was not in top 1
[2024-04-11 11:27:50,915][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 1320: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.041
[2024-04-11 11:28:08,063][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 1350: 'val_loss' reached 0.04128 (best 0.04128), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:28:24,948][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 1380: 'val_loss' was not in top 1
[2024-04-11 11:28:42,109][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 1410: 'val_loss' was not in top 1
[2024-04-11 11:28:59,351][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 1440: 'val_loss' was not in top 1
[2024-04-11 11:29:16,910][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 1470: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.041
[2024-04-11 11:29:34,516][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 1500: 'val_loss' reached 0.04056 (best 0.04056), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.040
[2024-04-11 11:29:51,980][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 50, global step 1530: 'val_loss' reached 0.03953 (best 0.03953), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:30:09,303][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 51, global step 1560: 'val_loss' was not in top 1
[2024-04-11 11:30:26,387][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 52, global step 1590: 'val_loss' was not in top 1
[2024-04-11 11:30:43,974][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 53, global step 1620: 'val_loss' was not in top 1
[2024-04-11 11:31:01,586][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 54, global step 1650: 'val_loss' was not in top 1
[2024-04-11 11:31:19,099][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 55, global step 1680: 'val_loss' was not in top 1
[2024-04-11 11:31:36,110][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 56, global step 1710: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.039
[2024-04-11 11:31:53,484][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 57, global step 1740: 'val_loss' reached 0.03919 (best 0.03919), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:32:10,443][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 58, global step 1770: 'val_loss' was not in top 1
[2024-04-11 11:32:27,933][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 59, global step 1800: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.038
[2024-04-11 11:32:45,418][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 60, global step 1830: 'val_loss' reached 0.03777 (best 0.03777), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:33:03,330][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 61, global step 1860: 'val_loss' was not in top 1
[2024-04-11 11:33:20,381][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 62, global step 1890: 'val_loss' was not in top 1
[2024-04-11 11:33:37,940][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 63, global step 1920: 'val_loss' was not in top 1
[2024-04-11 11:33:54,652][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 64, global step 1950: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.037
[2024-04-11 11:34:11,761][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 65, global step 1980: 'val_loss' reached 0.03714 (best 0.03714), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.037
[2024-04-11 11:34:29,412][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 66, global step 2010: 'val_loss' reached 0.03672 (best 0.03672), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.034
[2024-04-11 11:34:46,950][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 67, global step 2040: 'val_loss' reached 0.03416 (best 0.03416), saving model to '/tmp/tmpn__naepb/model_4.ckpt' as top 1
[2024-04-11 11:35:03,625][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 68, global step 2070: 'val_loss' was not in top 1
[2024-04-11 11:35:21,266][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 69, global step 2100: 'val_loss' was not in top 1
[2024-04-11 11:35:38,625][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 70, global step 2130: 'val_loss' was not in top 1
[2024-04-11 11:35:55,857][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 71, global step 2160: 'val_loss' was not in top 1
[2024-04-11 11:36:12,944][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 72, global step 2190: 'val_loss' was not in top 1
[2024-04-11 11:36:31,092][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 73, global step 2220: 'val_loss' was not in top 1
[2024-04-11 11:36:49,032][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 74, global step 2250: 'val_loss' was not in top 1
[2024-04-11 11:37:06,440][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 75, global step 2280: 'val_loss' was not in top 1
[2024-04-11 11:37:23,599][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 76, global step 2310: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.034. Signaling Trainer to stop.
[2024-04-11 11:37:40,710][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 77, global step 2340: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/11 11:37:43 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/11 11:37:43 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/11 11:37:43 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/11 11:37:43 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-11 11:37:43,463][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-11 11:37:43,463][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-11 11:37:43,463][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-11 11:37:43,463][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/11 11:37:43 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpn__naepb exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.193
[2024-04-11 11:38:06,707][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 30: 'val_loss' reached 0.19309 (best 0.19309), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
Metric val_loss improved by 0.038 >= min_delta = 1e-05. New best score: 0.156
[2024-04-11 11:38:23,834][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 60: 'val_loss' reached 0.15554 (best 0.15554), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
Metric val_loss improved by 0.015 >= min_delta = 1e-05. New best score: 0.140
[2024-04-11 11:38:40,956][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 90: 'val_loss' reached 0.14021 (best 0.14021), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
Metric val_loss improved by 0.020 >= min_delta = 1e-05. New best score: 0.120
[2024-04-11 11:38:58,475][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 120: 'val_loss' reached 0.12048 (best 0.12048), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.118
[2024-04-11 11:39:16,218][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 150: 'val_loss' reached 0.11838 (best 0.11838), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.111
[2024-04-11 11:39:34,138][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 180: 'val_loss' reached 0.11069 (best 0.11069), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.109
[2024-04-11 11:39:51,771][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 210: 'val_loss' reached 0.10916 (best 0.10916), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.100
[2024-04-11 11:40:09,551][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 240: 'val_loss' reached 0.10028 (best 0.10028), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
Metric val_loss improved by 0.011 >= min_delta = 1e-05. New best score: 0.089
[2024-04-11 11:40:26,888][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 270: 'val_loss' reached 0.08943 (best 0.08943), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.088
[2024-04-11 11:40:44,304][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 300: 'val_loss' reached 0.08815 (best 0.08815), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:41:01,569][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 330: 'val_loss' was not in top 1
Metric val_loss improved by 0.007 >= min_delta = 1e-05. New best score: 0.081
[2024-04-11 11:41:19,160][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 360: 'val_loss' reached 0.08095 (best 0.08095), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:41:36,712][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 390: 'val_loss' was not in top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.075
[2024-04-11 11:41:53,785][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 420: 'val_loss' reached 0.07494 (best 0.07494), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:42:10,940][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 450: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.073
[2024-04-11 11:42:27,330][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 480: 'val_loss' reached 0.07324 (best 0.07324), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:42:44,484][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 510: 'val_loss' was not in top 1
Metric val_loss improved by 0.014 >= min_delta = 1e-05. New best score: 0.059
[2024-04-11 11:43:02,323][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 540: 'val_loss' reached 0.05933 (best 0.05933), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:43:19,593][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 570: 'val_loss' was not in top 1
[2024-04-11 11:43:37,752][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 600: 'val_loss' was not in top 1
[2024-04-11 11:43:55,445][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 630: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.058
[2024-04-11 11:44:12,953][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 660: 'val_loss' reached 0.05773 (best 0.05773), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:44:30,012][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 690: 'val_loss' was not in top 1
[2024-04-11 11:44:47,647][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 720: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.057
[2024-04-11 11:45:05,302][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 750: 'val_loss' reached 0.05691 (best 0.05691), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.053
[2024-04-11 11:45:23,229][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 780: 'val_loss' reached 0.05322 (best 0.05322), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.052
[2024-04-11 11:45:40,544][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 810: 'val_loss' reached 0.05219 (best 0.05219), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:45:58,403][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 840: 'val_loss' was not in top 1
[2024-04-11 11:46:15,822][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 870: 'val_loss' was not in top 1
[2024-04-11 11:46:33,745][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 900: 'val_loss' was not in top 1
[2024-04-11 11:46:51,378][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 930: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.051
[2024-04-11 11:47:08,852][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 960: 'val_loss' reached 0.05147 (best 0.05147), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:47:26,535][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 990: 'val_loss' was not in top 1
[2024-04-11 11:47:44,123][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1020: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.050
[2024-04-11 11:48:01,555][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1050: 'val_loss' reached 0.04988 (best 0.04988), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:48:18,460][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 1080: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.047
[2024-04-11 11:48:35,356][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 1110: 'val_loss' reached 0.04738 (best 0.04738), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:48:52,170][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 1140: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.046
[2024-04-11 11:49:09,125][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 1170: 'val_loss' reached 0.04617 (best 0.04617), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:49:26,081][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 1200: 'val_loss' was not in top 1
[2024-04-11 11:49:43,059][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 1230: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.043
[2024-04-11 11:50:00,101][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 1260: 'val_loss' reached 0.04342 (best 0.04342), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:50:17,680][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 1290: 'val_loss' was not in top 1
[2024-04-11 11:50:34,957][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 1320: 'val_loss' reached 0.04341 (best 0.04341), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:50:52,758][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 1350: 'val_loss' was not in top 1
[2024-04-11 11:51:09,577][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 1380: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.041
[2024-04-11 11:51:27,254][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 1410: 'val_loss' reached 0.04132 (best 0.04132), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:51:44,970][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 1440: 'val_loss' was not in top 1
[2024-04-11 11:52:02,513][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 1470: 'val_loss' was not in top 1
[2024-04-11 11:52:20,327][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 1500: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.040
[2024-04-11 11:52:37,420][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 50, global step 1530: 'val_loss' reached 0.04016 (best 0.04016), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:52:54,354][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 51, global step 1560: 'val_loss' was not in top 1
[2024-04-11 11:53:11,583][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 52, global step 1590: 'val_loss' was not in top 1
[2024-04-11 11:53:29,643][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 53, global step 1620: 'val_loss' was not in top 1
[2024-04-11 11:53:46,728][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 54, global step 1650: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.038
[2024-04-11 11:54:03,899][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 55, global step 1680: 'val_loss' reached 0.03813 (best 0.03813), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:54:21,764][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 56, global step 1710: 'val_loss' was not in top 1
[2024-04-11 11:54:39,230][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 57, global step 1740: 'val_loss' was not in top 1
[2024-04-11 11:54:57,011][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 58, global step 1770: 'val_loss' was not in top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.033
[2024-04-11 11:55:14,841][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 59, global step 1800: 'val_loss' reached 0.03278 (best 0.03278), saving model to '/tmp/tmpn__naepb/model_5.ckpt' as top 1
[2024-04-11 11:55:31,603][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 60, global step 1830: 'val_loss' was not in top 1
[2024-04-11 11:55:49,043][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 61, global step 1860: 'val_loss' was not in top 1
[2024-04-11 11:56:06,605][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 62, global step 1890: 'val_loss' was not in top 1
[2024-04-11 11:56:24,096][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 63, global step 1920: 'val_loss' was not in top 1
[2024-04-11 11:56:41,151][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 64, global step 1950: 'val_loss' was not in top 1
[2024-04-11 11:56:58,617][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 65, global step 1980: 'val_loss' was not in top 1
[2024-04-11 11:57:15,256][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 66, global step 2010: 'val_loss' was not in top 1
[2024-04-11 11:57:32,973][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 67, global step 2040: 'val_loss' was not in top 1
[2024-04-11 11:57:50,873][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 68, global step 2070: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.033. Signaling Trainer to stop.
[2024-04-11 11:58:07,812][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 69, global step 2100: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/11 11:58:10 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/11 11:58:10 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/11 11:58:10 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/11 11:58:10 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-11 11:58:10,512][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-11 11:58:10,512][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-11 11:58:10,512][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-11 11:58:10,512][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/11 11:58:10 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpn__naepb exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.197
[2024-04-11 11:58:33,178][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 30: 'val_loss' reached 0.19658 (best 0.19658), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.038 >= min_delta = 1e-05. New best score: 0.158
[2024-04-11 11:58:50,428][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 60: 'val_loss' reached 0.15817 (best 0.15817), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.024 >= min_delta = 1e-05. New best score: 0.134
[2024-04-11 11:59:07,691][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 90: 'val_loss' reached 0.13402 (best 0.13402), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 11:59:25,294][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 120: 'val_loss' was not in top 1
Metric val_loss improved by 0.014 >= min_delta = 1e-05. New best score: 0.120
[2024-04-11 11:59:42,993][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 150: 'val_loss' reached 0.12043 (best 0.12043), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.113
[2024-04-11 12:00:00,656][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 180: 'val_loss' reached 0.11269 (best 0.11269), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.110
[2024-04-11 12:00:17,505][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 210: 'val_loss' reached 0.11035 (best 0.11035), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.007 >= min_delta = 1e-05. New best score: 0.103
[2024-04-11 12:00:35,263][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 240: 'val_loss' reached 0.10325 (best 0.10325), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.099
[2024-04-11 12:00:52,751][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 270: 'val_loss' reached 0.09939 (best 0.09939), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.010 >= min_delta = 1e-05. New best score: 0.089
[2024-04-11 12:01:10,450][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 300: 'val_loss' reached 0.08930 (best 0.08930), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:01:28,470][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 330: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.087
[2024-04-11 12:01:45,703][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 360: 'val_loss' reached 0.08650 (best 0.08650), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.012 >= min_delta = 1e-05. New best score: 0.075
[2024-04-11 12:02:03,450][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 390: 'val_loss' reached 0.07465 (best 0.07465), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:02:20,749][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 420: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.073
[2024-04-11 12:02:38,284][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 450: 'val_loss' reached 0.07308 (best 0.07308), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:02:55,636][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 480: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.072
[2024-04-11 12:03:12,378][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 510: 'val_loss' reached 0.07196 (best 0.07196), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.063
[2024-04-11 12:03:29,321][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 540: 'val_loss' reached 0.06340 (best 0.06340), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:03:46,950][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 570: 'val_loss' was not in top 1
[2024-04-11 12:04:04,203][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 600: 'val_loss' was not in top 1
[2024-04-11 12:04:20,932][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 630: 'val_loss' was not in top 1
[2024-04-11 12:04:38,506][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 660: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.059
[2024-04-11 12:04:56,240][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 690: 'val_loss' reached 0.05928 (best 0.05928), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.056
[2024-04-11 12:05:14,243][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 720: 'val_loss' reached 0.05644 (best 0.05644), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:05:31,551][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 750: 'val_loss' was not in top 1
[2024-04-11 12:05:48,939][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 780: 'val_loss' was not in top 1
[2024-04-11 12:06:06,321][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 810: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.055
[2024-04-11 12:06:23,361][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 840: 'val_loss' reached 0.05535 (best 0.05535), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.053
[2024-04-11 12:06:40,921][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 870: 'val_loss' reached 0.05296 (best 0.05296), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.053
[2024-04-11 12:06:58,471][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 900: 'val_loss' reached 0.05292 (best 0.05292), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.051
[2024-04-11 12:07:16,025][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 930: 'val_loss' reached 0.05058 (best 0.05058), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.046
[2024-04-11 12:07:33,303][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 960: 'val_loss' reached 0.04580 (best 0.04580), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:07:50,844][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 990: 'val_loss' was not in top 1
[2024-04-11 12:08:08,770][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1020: 'val_loss' was not in top 1
[2024-04-11 12:08:26,142][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1050: 'val_loss' was not in top 1
[2024-04-11 12:08:43,309][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 1080: 'val_loss' was not in top 1
[2024-04-11 12:09:00,866][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 1110: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.044
[2024-04-11 12:09:18,932][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 1140: 'val_loss' reached 0.04432 (best 0.04432), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:09:37,050][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 1170: 'val_loss' was not in top 1
[2024-04-11 12:09:54,366][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 1200: 'val_loss' was not in top 1
[2024-04-11 12:10:11,629][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 1230: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.044
[2024-04-11 12:10:28,345][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 1260: 'val_loss' reached 0.04403 (best 0.04403), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:10:46,262][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 1290: 'val_loss' was not in top 1
[2024-04-11 12:11:03,949][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 1320: 'val_loss' was not in top 1
[2024-04-11 12:11:21,936][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 1350: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.040
[2024-04-11 12:11:39,882][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 1380: 'val_loss' reached 0.04025 (best 0.04025), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.040
[2024-04-11 12:11:57,391][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 1410: 'val_loss' reached 0.03958 (best 0.03958), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:12:14,286][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 1440: 'val_loss' was not in top 1
[2024-04-11 12:12:31,729][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 1470: 'val_loss' was not in top 1
[2024-04-11 12:12:49,094][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 1500: 'val_loss' was not in top 1
[2024-04-11 12:13:06,928][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 50, global step 1530: 'val_loss' was not in top 1
[2024-04-11 12:13:23,590][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 51, global step 1560: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.039
[2024-04-11 12:13:40,976][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 52, global step 1590: 'val_loss' reached 0.03948 (best 0.03948), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:13:58,886][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 53, global step 1620: 'val_loss' was not in top 1
[2024-04-11 12:14:16,319][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 54, global step 1650: 'val_loss' was not in top 1
[2024-04-11 12:14:34,120][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 55, global step 1680: 'val_loss' was not in top 1
[2024-04-11 12:14:50,991][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 56, global step 1710: 'val_loss' was not in top 1
[2024-04-11 12:15:08,303][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 57, global step 1740: 'val_loss' was not in top 1
[2024-04-11 12:15:26,204][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 58, global step 1770: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.039
[2024-04-11 12:15:44,069][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 59, global step 1800: 'val_loss' reached 0.03929 (best 0.03929), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.036
[2024-04-11 12:16:01,888][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 60, global step 1830: 'val_loss' reached 0.03596 (best 0.03596), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:16:19,548][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 61, global step 1860: 'val_loss' was not in top 1
[2024-04-11 12:16:36,487][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 62, global step 1890: 'val_loss' was not in top 1
[2024-04-11 12:16:53,445][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 63, global step 1920: 'val_loss' was not in top 1
[2024-04-11 12:17:10,620][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 64, global step 1950: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.033
[2024-04-11 12:17:28,708][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 65, global step 1980: 'val_loss' reached 0.03300 (best 0.03300), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:17:46,574][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 66, global step 2010: 'val_loss' was not in top 1
[2024-04-11 12:18:04,664][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 67, global step 2040: 'val_loss' was not in top 1
[2024-04-11 12:18:22,096][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 68, global step 2070: 'val_loss' was not in top 1
[2024-04-11 12:18:39,711][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 69, global step 2100: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.032
[2024-04-11 12:18:56,766][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 70, global step 2130: 'val_loss' reached 0.03246 (best 0.03246), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:19:13,464][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 71, global step 2160: 'val_loss' was not in top 1
[2024-04-11 12:19:30,586][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 72, global step 2190: 'val_loss' was not in top 1
[2024-04-11 12:19:48,052][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 73, global step 2220: 'val_loss' was not in top 1
[2024-04-11 12:20:05,124][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 74, global step 2250: 'val_loss' was not in top 1
[2024-04-11 12:20:22,540][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 75, global step 2280: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.032
[2024-04-11 12:20:40,408][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 76, global step 2310: 'val_loss' reached 0.03208 (best 0.03208), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:20:57,775][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 77, global step 2340: 'val_loss' was not in top 1
[2024-04-11 12:21:14,488][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 78, global step 2370: 'val_loss' was not in top 1
[2024-04-11 12:21:31,896][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 79, global step 2400: 'val_loss' was not in top 1
[2024-04-11 12:21:49,726][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 80, global step 2430: 'val_loss' was not in top 1
[2024-04-11 12:22:07,349][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 81, global step 2460: 'val_loss' was not in top 1
[2024-04-11 12:22:25,374][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 82, global step 2490: 'val_loss' was not in top 1
[2024-04-11 12:22:43,511][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 83, global step 2520: 'val_loss' was not in top 1
[2024-04-11 12:23:01,371][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 84, global step 2550: 'val_loss' was not in top 1
[2024-04-11 12:23:18,936][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 85, global step 2580: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.031
[2024-04-11 12:23:36,720][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 86, global step 2610: 'val_loss' reached 0.03076 (best 0.03076), saving model to '/tmp/tmpn__naepb/model_6.ckpt' as top 1
[2024-04-11 12:23:54,583][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 87, global step 2640: 'val_loss' was not in top 1
[2024-04-11 12:24:12,387][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 88, global step 2670: 'val_loss' was not in top 1
[2024-04-11 12:24:29,859][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 89, global step 2700: 'val_loss' was not in top 1
[2024-04-11 12:24:47,391][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 90, global step 2730: 'val_loss' was not in top 1
[2024-04-11 12:25:04,445][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 91, global step 2760: 'val_loss' was not in top 1
[2024-04-11 12:25:22,131][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 92, global step 2790: 'val_loss' was not in top 1
[2024-04-11 12:25:39,588][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 93, global step 2820: 'val_loss' was not in top 1
[2024-04-11 12:25:57,037][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 94, global step 2850: 'val_loss' was not in top 1
[2024-04-11 12:26:14,919][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 95, global step 2880: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.031. Signaling Trainer to stop.
[2024-04-11 12:26:32,605][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 96, global step 2910: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/11 12:26:35 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/11 12:26:35 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/11 12:26:35 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/11 12:26:35 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-11 12:26:35,289][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-11 12:26:35,289][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-11 12:26:35,289][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-11 12:26:35,289][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/11 12:26:35 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpn__naepb exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.199
[2024-04-11 12:26:58,145][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 30: 'val_loss' reached 0.19923 (best 0.19923), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
Metric val_loss improved by 0.049 >= min_delta = 1e-05. New best score: 0.150
[2024-04-11 12:27:15,778][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 60: 'val_loss' reached 0.14976 (best 0.14976), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
Metric val_loss improved by 0.015 >= min_delta = 1e-05. New best score: 0.135
[2024-04-11 12:27:32,976][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 90: 'val_loss' reached 0.13504 (best 0.13504), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
Metric val_loss improved by 0.012 >= min_delta = 1e-05. New best score: 0.123
[2024-04-11 12:27:50,710][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 120: 'val_loss' reached 0.12292 (best 0.12292), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.120
[2024-04-11 12:28:08,596][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 150: 'val_loss' reached 0.11976 (best 0.11976), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.115
[2024-04-11 12:28:26,683][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 180: 'val_loss' reached 0.11483 (best 0.11483), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
Metric val_loss improved by 0.013 >= min_delta = 1e-05. New best score: 0.102
[2024-04-11 12:28:44,341][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 210: 'val_loss' reached 0.10156 (best 0.10156), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.101
[2024-04-11 12:29:02,428][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 240: 'val_loss' reached 0.10139 (best 0.10139), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.098
[2024-04-11 12:29:20,051][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 270: 'val_loss' reached 0.09775 (best 0.09775), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.098
[2024-04-11 12:29:37,805][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 300: 'val_loss' reached 0.09768 (best 0.09768), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.094
[2024-04-11 12:29:55,229][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 330: 'val_loss' reached 0.09389 (best 0.09389), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
Metric val_loss improved by 0.011 >= min_delta = 1e-05. New best score: 0.083
[2024-04-11 12:30:12,485][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 360: 'val_loss' reached 0.08281 (best 0.08281), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
[2024-04-11 12:30:30,117][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 390: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.079
[2024-04-11 12:30:47,850][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 420: 'val_loss' reached 0.07869 (best 0.07869), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.075
[2024-04-11 12:31:05,772][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 450: 'val_loss' reached 0.07535 (best 0.07535), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
[2024-04-11 12:31:23,550][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 480: 'val_loss' was not in top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.066
[2024-04-11 12:31:40,667][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 510: 'val_loss' reached 0.06617 (best 0.06617), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
[2024-04-11 12:31:58,930][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 540: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.065
[2024-04-11 12:32:16,634][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 570: 'val_loss' reached 0.06469 (best 0.06469), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
[2024-04-11 12:32:34,356][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 600: 'val_loss' was not in top 1
[2024-04-11 12:32:52,540][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 630: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.061
[2024-04-11 12:33:10,564][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 660: 'val_loss' reached 0.06123 (best 0.06123), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
[2024-04-11 12:33:28,460][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 690: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.058
[2024-04-11 12:33:45,735][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 720: 'val_loss' reached 0.05770 (best 0.05770), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
[2024-04-11 12:34:02,918][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 750: 'val_loss' was not in top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.052
[2024-04-11 12:34:20,041][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 780: 'val_loss' reached 0.05238 (best 0.05238), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.049
[2024-04-11 12:34:38,010][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 810: 'val_loss' reached 0.04882 (best 0.04882), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
[2024-04-11 12:34:55,917][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 840: 'val_loss' was not in top 1
[2024-04-11 12:35:13,930][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 870: 'val_loss' was not in top 1
[2024-04-11 12:35:32,213][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 900: 'val_loss' was not in top 1
[2024-04-11 12:35:49,816][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 930: 'val_loss' was not in top 1
[2024-04-11 12:36:07,618][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 960: 'val_loss' was not in top 1
[2024-04-11 12:36:25,773][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 990: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.045
[2024-04-11 12:36:43,468][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1020: 'val_loss' reached 0.04504 (best 0.04504), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
[2024-04-11 12:37:01,229][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1050: 'val_loss' was not in top 1
[2024-04-11 12:37:19,500][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 1080: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.044
[2024-04-11 12:37:37,356][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 1110: 'val_loss' reached 0.04400 (best 0.04400), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
[2024-04-11 12:37:55,033][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 1140: 'val_loss' was not in top 1
[2024-04-11 12:38:13,283][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 1170: 'val_loss' was not in top 1
[2024-04-11 12:38:31,329][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 1200: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.042
[2024-04-11 12:38:49,127][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 1230: 'val_loss' reached 0.04195 (best 0.04195), saving model to '/tmp/tmpn__naepb/model_7.ckpt' as top 1
[2024-04-11 12:39:05,985][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 1260: 'val_loss' was not in top 1
[2024-04-11 12:39:23,458][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 1290: 'val_loss' was not in top 1
[2024-04-11 12:39:41,007][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 1320: 'val_loss' was not in top 1
[2024-04-11 12:39:58,631][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 1350: 'val_loss' was not in top 1
[2024-04-11 12:40:16,110][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 1380: 'val_loss' was not in top 1
[2024-04-11 12:40:33,492][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 1410: 'val_loss' was not in top 1
[2024-04-11 12:40:50,534][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 1440: 'val_loss' was not in top 1
[2024-04-11 12:41:08,181][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 1470: 'val_loss' was not in top 1
[2024-04-11 12:41:26,319][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 1500: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.042. Signaling Trainer to stop.
[2024-04-11 12:41:44,217][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 50, global step 1530: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/11 12:41:46 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/11 12:41:46 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/11 12:41:46 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/11 12:41:46 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-11 12:41:46,909][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-11 12:41:46,909][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-11 12:41:46,909][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-11 12:41:46,909][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/11 12:41:46 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpn__naepb exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.192
[2024-04-11 12:42:10,327][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 30: 'val_loss' reached 0.19231 (best 0.19231), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
Metric val_loss improved by 0.043 >= min_delta = 1e-05. New best score: 0.149
[2024-04-11 12:42:28,309][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 60: 'val_loss' reached 0.14905 (best 0.14905), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.146
[2024-04-11 12:42:45,231][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 90: 'val_loss' reached 0.14647 (best 0.14647), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
Metric val_loss improved by 0.015 >= min_delta = 1e-05. New best score: 0.131
[2024-04-11 12:43:02,463][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 120: 'val_loss' reached 0.13098 (best 0.13098), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
Metric val_loss improved by 0.016 >= min_delta = 1e-05. New best score: 0.115
[2024-04-11 12:43:19,837][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 150: 'val_loss' reached 0.11545 (best 0.11545), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
Metric val_loss improved by 0.010 >= min_delta = 1e-05. New best score: 0.106
[2024-04-11 12:43:38,182][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 180: 'val_loss' reached 0.10554 (best 0.10554), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:43:56,045][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 210: 'val_loss' was not in top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.100
[2024-04-11 12:44:13,540][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 240: 'val_loss' reached 0.10015 (best 0.10015), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.098
[2024-04-11 12:44:31,237][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 270: 'val_loss' reached 0.09765 (best 0.09765), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.092
[2024-04-11 12:44:48,517][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 300: 'val_loss' reached 0.09188 (best 0.09188), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.089
[2024-04-11 12:45:05,328][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 330: 'val_loss' reached 0.08931 (best 0.08931), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:45:22,611][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 360: 'val_loss' was not in top 1
Metric val_loss improved by 0.010 >= min_delta = 1e-05. New best score: 0.080
[2024-04-11 12:45:40,078][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 390: 'val_loss' reached 0.07977 (best 0.07977), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:45:57,761][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 420: 'val_loss' was not in top 1
[2024-04-11 12:46:14,260][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 450: 'val_loss' was not in top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.072
[2024-04-11 12:46:31,389][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 480: 'val_loss' reached 0.07208 (best 0.07208), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.070
[2024-04-11 12:46:49,506][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 510: 'val_loss' reached 0.07048 (best 0.07048), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.061
[2024-04-11 12:47:07,876][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 540: 'val_loss' reached 0.06099 (best 0.06099), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:47:25,490][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 570: 'val_loss' was not in top 1
[2024-04-11 12:47:42,801][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 600: 'val_loss' was not in top 1
[2024-04-11 12:47:59,949][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 630: 'val_loss' was not in top 1
[2024-04-11 12:48:17,256][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 660: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.058
[2024-04-11 12:48:35,196][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 690: 'val_loss' reached 0.05786 (best 0.05786), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:48:52,379][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 720: 'val_loss' was not in top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.052
[2024-04-11 12:49:09,432][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 750: 'val_loss' reached 0.05248 (best 0.05248), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:49:27,057][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 780: 'val_loss' was not in top 1
[2024-04-11 12:49:44,425][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 810: 'val_loss' was not in top 1
[2024-04-11 12:50:01,808][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 840: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.052
[2024-04-11 12:50:19,116][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 870: 'val_loss' reached 0.05185 (best 0.05185), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:50:37,430][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 900: 'val_loss' was not in top 1
[2024-04-11 12:50:55,820][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 930: 'val_loss' was not in top 1
[2024-04-11 12:51:14,156][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 960: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.048
[2024-04-11 12:51:32,210][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 990: 'val_loss' reached 0.04816 (best 0.04816), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:51:50,305][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1020: 'val_loss' was not in top 1
[2024-04-11 12:52:07,933][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1050: 'val_loss' was not in top 1
[2024-04-11 12:52:25,715][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 1080: 'val_loss' was not in top 1
[2024-04-11 12:52:43,100][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 1110: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.045
[2024-04-11 12:53:00,827][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 1140: 'val_loss' reached 0.04512 (best 0.04512), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:53:18,936][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 1170: 'val_loss' was not in top 1
[2024-04-11 12:53:37,076][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 1200: 'val_loss' was not in top 1
[2024-04-11 12:53:54,560][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 1230: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.044
[2024-04-11 12:54:12,403][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 1260: 'val_loss' reached 0.04438 (best 0.04438), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:54:29,724][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 1290: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.044
[2024-04-11 12:54:47,431][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 1320: 'val_loss' reached 0.04352 (best 0.04352), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.043
[2024-04-11 12:55:04,967][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 1350: 'val_loss' reached 0.04332 (best 0.04332), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:55:22,683][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 1380: 'val_loss' was not in top 1
[2024-04-11 12:55:40,350][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 1410: 'val_loss' was not in top 1
[2024-04-11 12:55:57,646][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 1440: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.043
[2024-04-11 12:56:15,854][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 1470: 'val_loss' reached 0.04326 (best 0.04326), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.041
[2024-04-11 12:56:33,483][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 1500: 'val_loss' reached 0.04086 (best 0.04086), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:56:51,204][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 50, global step 1530: 'val_loss' was not in top 1
[2024-04-11 12:57:08,474][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 51, global step 1560: 'val_loss' was not in top 1
[2024-04-11 12:57:26,352][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 52, global step 1590: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.040
[2024-04-11 12:57:44,149][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 53, global step 1620: 'val_loss' reached 0.03991 (best 0.03991), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:58:01,994][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 54, global step 1650: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.038
[2024-04-11 12:58:19,366][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 55, global step 1680: 'val_loss' reached 0.03809 (best 0.03809), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 12:58:37,120][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 56, global step 1710: 'val_loss' was not in top 1
[2024-04-11 12:58:55,045][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 57, global step 1740: 'val_loss' was not in top 1
[2024-04-11 12:59:12,807][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 58, global step 1770: 'val_loss' was not in top 1
[2024-04-11 12:59:30,063][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 59, global step 1800: 'val_loss' was not in top 1
[2024-04-11 12:59:47,201][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 60, global step 1830: 'val_loss' was not in top 1
[2024-04-11 13:00:05,250][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 61, global step 1860: 'val_loss' was not in top 1
[2024-04-11 13:00:23,418][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 62, global step 1890: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.038
[2024-04-11 13:00:41,336][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 63, global step 1920: 'val_loss' reached 0.03766 (best 0.03766), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 13:00:59,309][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 64, global step 1950: 'val_loss' was not in top 1
[2024-04-11 13:01:16,482][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 65, global step 1980: 'val_loss' was not in top 1
[2024-04-11 13:01:34,599][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 66, global step 2010: 'val_loss' was not in top 1
[2024-04-11 13:01:52,055][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 67, global step 2040: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.037
[2024-04-11 13:02:09,206][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 68, global step 2070: 'val_loss' reached 0.03703 (best 0.03703), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 13:02:27,043][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 69, global step 2100: 'val_loss' was not in top 1
[2024-04-11 13:02:44,831][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 70, global step 2130: 'val_loss' was not in top 1
[2024-04-11 13:03:03,197][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 71, global step 2160: 'val_loss' was not in top 1
[2024-04-11 13:03:20,447][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 72, global step 2190: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.036
[2024-04-11 13:03:38,276][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 73, global step 2220: 'val_loss' reached 0.03560 (best 0.03560), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 13:03:55,791][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 74, global step 2250: 'val_loss' was not in top 1
[2024-04-11 13:04:12,849][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 75, global step 2280: 'val_loss' was not in top 1
[2024-04-11 13:04:30,615][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 76, global step 2310: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.035
[2024-04-11 13:04:48,291][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 77, global step 2340: 'val_loss' reached 0.03465 (best 0.03465), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 13:05:05,909][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 78, global step 2370: 'val_loss' was not in top 1
[2024-04-11 13:05:24,005][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 79, global step 2400: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.034
[2024-04-11 13:05:41,605][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 80, global step 2430: 'val_loss' reached 0.03363 (best 0.03363), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 13:05:59,381][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 81, global step 2460: 'val_loss' was not in top 1
[2024-04-11 13:06:16,730][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 82, global step 2490: 'val_loss' was not in top 1
[2024-04-11 13:06:34,915][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 83, global step 2520: 'val_loss' was not in top 1
[2024-04-11 13:06:52,654][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 84, global step 2550: 'val_loss' was not in top 1
[2024-04-11 13:07:09,995][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 85, global step 2580: 'val_loss' was not in top 1
[2024-04-11 13:07:27,605][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 86, global step 2610: 'val_loss' was not in top 1
[2024-04-11 13:07:45,839][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 87, global step 2640: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.031
[2024-04-11 13:08:02,875][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 88, global step 2670: 'val_loss' reached 0.03085 (best 0.03085), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 13:08:20,457][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 89, global step 2700: 'val_loss' was not in top 1
[2024-04-11 13:08:37,813][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 90, global step 2730: 'val_loss' was not in top 1
[2024-04-11 13:08:54,827][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 91, global step 2760: 'val_loss' was not in top 1
[2024-04-11 13:09:11,962][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 92, global step 2790: 'val_loss' was not in top 1
[2024-04-11 13:09:29,589][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 93, global step 2820: 'val_loss' was not in top 1
[2024-04-11 13:09:47,854][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 94, global step 2850: 'val_loss' was not in top 1
[2024-04-11 13:10:06,055][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 95, global step 2880: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.028
[2024-04-11 13:10:23,432][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 96, global step 2910: 'val_loss' reached 0.02800 (best 0.02800), saving model to '/tmp/tmpn__naepb/model_8.ckpt' as top 1
[2024-04-11 13:10:40,621][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 97, global step 2940: 'val_loss' was not in top 1
[2024-04-11 13:10:57,836][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 98, global step 2970: 'val_loss' was not in top 1
[2024-04-11 13:11:15,363][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 99, global step 3000: 'val_loss' was not in top 1
[2024-04-11 13:11:32,820][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 100, global step 3030: 'val_loss' was not in top 1
[2024-04-11 13:11:50,124][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 101, global step 3060: 'val_loss' was not in top 1
[2024-04-11 13:12:07,915][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 102, global step 3090: 'val_loss' was not in top 1
[2024-04-11 13:12:25,739][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 103, global step 3120: 'val_loss' was not in top 1
[2024-04-11 13:12:43,650][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 104, global step 3150: 'val_loss' was not in top 1
[2024-04-11 13:13:00,742][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 105, global step 3180: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.028. Signaling Trainer to stop.
[2024-04-11 13:13:18,325][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 106, global step 3210: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/11 13:13:21 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/11 13:13:21 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/11 13:13:21 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/11 13:13:21 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-11 13:13:21,177][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-11 13:13:21,177][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-11 13:13:21,177][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-11 13:13:21,177][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/11 13:13:21 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpn__naepb exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.193
[2024-04-11 13:13:43,799][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 30: 'val_loss' reached 0.19262 (best 0.19262), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
Metric val_loss improved by 0.030 >= min_delta = 1e-05. New best score: 0.163
[2024-04-11 13:14:00,841][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 60: 'val_loss' reached 0.16259 (best 0.16259), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
Metric val_loss improved by 0.025 >= min_delta = 1e-05. New best score: 0.138
[2024-04-11 13:14:17,782][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 90: 'val_loss' reached 0.13754 (best 0.13754), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.133
[2024-04-11 13:14:35,631][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 120: 'val_loss' reached 0.13277 (best 0.13277), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
Metric val_loss improved by 0.015 >= min_delta = 1e-05. New best score: 0.118
[2024-04-11 13:14:53,118][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 150: 'val_loss' reached 0.11793 (best 0.11793), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
Metric val_loss improved by 0.010 >= min_delta = 1e-05. New best score: 0.108
[2024-04-11 13:15:10,161][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 180: 'val_loss' reached 0.10754 (best 0.10754), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:15:28,369][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 210: 'val_loss' was not in top 1
Metric val_loss improved by 0.014 >= min_delta = 1e-05. New best score: 0.093
[2024-04-11 13:15:45,699][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 240: 'val_loss' reached 0.09308 (best 0.09308), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:16:02,805][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 270: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.091
[2024-04-11 13:16:19,759][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 300: 'val_loss' reached 0.09073 (best 0.09073), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.086
[2024-04-11 13:16:37,048][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 330: 'val_loss' reached 0.08635 (best 0.08635), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.082
[2024-04-11 13:16:54,778][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 360: 'val_loss' reached 0.08156 (best 0.08156), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:17:12,099][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 390: 'val_loss' was not in top 1
Metric val_loss improved by 0.007 >= min_delta = 1e-05. New best score: 0.075
[2024-04-11 13:17:29,563][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 420: 'val_loss' reached 0.07487 (best 0.07487), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.070
[2024-04-11 13:17:47,072][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 450: 'val_loss' reached 0.06993 (best 0.06993), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:18:04,435][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 480: 'val_loss' was not in top 1
[2024-04-11 13:18:21,571][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 510: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.067
[2024-04-11 13:18:38,970][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 540: 'val_loss' reached 0.06688 (best 0.06688), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:18:56,841][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 570: 'val_loss' was not in top 1
[2024-04-11 13:19:15,073][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 600: 'val_loss' was not in top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.061
[2024-04-11 13:19:32,758][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 630: 'val_loss' reached 0.06082 (best 0.06082), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.058
[2024-04-11 13:19:50,224][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 660: 'val_loss' reached 0.05785 (best 0.05785), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:20:08,032][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 690: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.055
[2024-04-11 13:20:25,355][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 720: 'val_loss' reached 0.05497 (best 0.05497), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:20:43,379][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 750: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.053
[2024-04-11 13:21:00,477][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 780: 'val_loss' reached 0.05323 (best 0.05323), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:21:17,832][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 810: 'val_loss' was not in top 1
[2024-04-11 13:21:35,091][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 840: 'val_loss' was not in top 1
[2024-04-11 13:21:52,473][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 870: 'val_loss' was not in top 1
[2024-04-11 13:22:09,769][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 900: 'val_loss' was not in top 1
[2024-04-11 13:22:27,069][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 930: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.052
[2024-04-11 13:22:44,290][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 960: 'val_loss' reached 0.05235 (best 0.05235), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.049
[2024-04-11 13:23:02,013][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 990: 'val_loss' reached 0.04950 (best 0.04950), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:23:19,376][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 1020: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.046
[2024-04-11 13:23:36,787][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 1050: 'val_loss' reached 0.04639 (best 0.04639), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:23:54,747][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 1080: 'val_loss' was not in top 1
[2024-04-11 13:24:12,704][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 1110: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.044
[2024-04-11 13:24:30,720][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 1140: 'val_loss' reached 0.04377 (best 0.04377), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:24:47,831][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 1170: 'val_loss' was not in top 1
[2024-04-11 13:25:04,947][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 1200: 'val_loss' was not in top 1
[2024-04-11 13:25:22,223][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 1230: 'val_loss' was not in top 1
[2024-04-11 13:25:39,804][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 1260: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.041
[2024-04-11 13:25:57,461][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 1290: 'val_loss' reached 0.04088 (best 0.04088), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:26:15,435][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 1320: 'val_loss' was not in top 1
[2024-04-11 13:26:32,813][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 1350: 'val_loss' was not in top 1
[2024-04-11 13:26:50,246][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 1380: 'val_loss' was not in top 1
[2024-04-11 13:27:08,034][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 1410: 'val_loss' was not in top 1
[2024-04-11 13:27:25,766][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 1440: 'val_loss' was not in top 1
[2024-04-11 13:27:43,173][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 1470: 'val_loss' was not in top 1
[2024-04-11 13:28:00,933][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 1500: 'val_loss' was not in top 1
[2024-04-11 13:28:18,766][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 50, global step 1530: 'val_loss' was not in top 1
[2024-04-11 13:28:35,969][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 51, global step 1560: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.040
[2024-04-11 13:28:53,912][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 52, global step 1590: 'val_loss' reached 0.04016 (best 0.04016), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:29:11,340][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 53, global step 1620: 'val_loss' was not in top 1
[2024-04-11 13:29:29,161][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 54, global step 1650: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.039
[2024-04-11 13:29:46,831][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 55, global step 1680: 'val_loss' reached 0.03878 (best 0.03878), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:30:04,205][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 56, global step 1710: 'val_loss' was not in top 1
[2024-04-11 13:30:21,834][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 57, global step 1740: 'val_loss' was not in top 1
[2024-04-11 13:30:39,104][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 58, global step 1770: 'val_loss' was not in top 1
[2024-04-11 13:30:56,677][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 59, global step 1800: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.037
[2024-04-11 13:31:14,375][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 60, global step 1830: 'val_loss' reached 0.03729 (best 0.03729), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:31:31,856][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 61, global step 1860: 'val_loss' was not in top 1
[2024-04-11 13:31:49,654][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 62, global step 1890: 'val_loss' was not in top 1
[2024-04-11 13:32:07,200][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 63, global step 1920: 'val_loss' was not in top 1
[2024-04-11 13:32:25,303][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 64, global step 1950: 'val_loss' was not in top 1
[2024-04-11 13:32:43,331][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 65, global step 1980: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.036
[2024-04-11 13:33:01,184][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 66, global step 2010: 'val_loss' reached 0.03596 (best 0.03596), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:33:18,523][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 67, global step 2040: 'val_loss' was not in top 1
[2024-04-11 13:33:35,855][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 68, global step 2070: 'val_loss' was not in top 1
[2024-04-11 13:33:53,165][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 69, global step 2100: 'val_loss' was not in top 1
[2024-04-11 13:34:10,900][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 70, global step 2130: 'val_loss' was not in top 1
[2024-04-11 13:34:28,033][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 71, global step 2160: 'val_loss' was not in top 1
[2024-04-11 13:34:45,676][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 72, global step 2190: 'val_loss' was not in top 1
[2024-04-11 13:35:03,208][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 73, global step 2220: 'val_loss' was not in top 1
[2024-04-11 13:35:20,654][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 74, global step 2250: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.033
[2024-04-11 13:35:38,350][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 75, global step 2280: 'val_loss' reached 0.03295 (best 0.03295), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:35:56,053][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 76, global step 2310: 'val_loss' was not in top 1
[2024-04-11 13:36:13,728][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 77, global step 2340: 'val_loss' was not in top 1
[2024-04-11 13:36:31,073][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 78, global step 2370: 'val_loss' was not in top 1
[2024-04-11 13:36:48,786][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 79, global step 2400: 'val_loss' was not in top 1
[2024-04-11 13:37:06,053][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 80, global step 2430: 'val_loss' was not in top 1
[2024-04-11 13:37:23,524][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 81, global step 2460: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.032
[2024-04-11 13:37:40,715][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 82, global step 2490: 'val_loss' reached 0.03204 (best 0.03204), saving model to '/tmp/tmpn__naepb/model_9.ckpt' as top 1
[2024-04-11 13:37:58,066][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 83, global step 2520: 'val_loss' was not in top 1
[2024-04-11 13:38:15,293][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 84, global step 2550: 'val_loss' was not in top 1
[2024-04-11 13:38:32,859][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 85, global step 2580: 'val_loss' was not in top 1
[2024-04-11 13:38:50,056][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 86, global step 2610: 'val_loss' was not in top 1
[2024-04-11 13:39:07,770][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 87, global step 2640: 'val_loss' was not in top 1
[2024-04-11 13:39:25,032][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 88, global step 2670: 'val_loss' was not in top 1
[2024-04-11 13:39:42,807][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 89, global step 2700: 'val_loss' was not in top 1
[2024-04-11 13:39:59,848][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 90, global step 2730: 'val_loss' was not in top 1
[2024-04-11 13:40:16,727][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 91, global step 2760: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.032. Signaling Trainer to stop.
[2024-04-11 13:40:34,336][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 92, global step 2790: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/11 13:40:37 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/11 13:40:37 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
