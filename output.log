2024/04/12 16:42:47 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/12 16:42:47 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-12 16:42:48,006][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-12 16:42:48,011][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-12 16:42:48,011][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-12 16:42:48,011][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/12 16:42:48 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
[2024-04-12 16:42:48,030][pytorch_lightning.utilities.rank_zero][INFO] - You are using a CUDA device ('NVIDIA GeForce RTX 4090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/utilities/model_summary/model_summary.py:454: A layer with UninitializedParameter was found. Thus, the total number of parameters detected may be inaccurate.

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.080
[2024-04-12 16:43:33,995][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 89: 'val_loss' reached 0.07956 (best 0.07956), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.074
[2024-04-12 16:44:15,661][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 178: 'val_loss' reached 0.07407 (best 0.07407), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
Metric val_loss improved by 0.011 >= min_delta = 1e-05. New best score: 0.064
[2024-04-12 16:44:57,200][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 267: 'val_loss' reached 0.06356 (best 0.06356), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
[2024-04-12 16:45:38,030][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 356: 'val_loss' was not in top 1
Metric val_loss improved by 0.011 >= min_delta = 1e-05. New best score: 0.052
[2024-04-12 16:46:19,049][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 445: 'val_loss' reached 0.05234 (best 0.05234), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
[2024-04-12 16:46:59,281][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 534: 'val_loss' was not in top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.045
[2024-04-12 16:47:40,602][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 623: 'val_loss' reached 0.04465 (best 0.04465), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
[2024-04-12 16:48:21,026][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 712: 'val_loss' was not in top 1
[2024-04-12 16:49:02,627][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 801: 'val_loss' was not in top 1
[2024-04-12 16:49:44,154][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 890: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.042
[2024-04-12 16:50:25,224][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 979: 'val_loss' reached 0.04213 (best 0.04213), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.040
[2024-04-12 16:51:06,073][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 1068: 'val_loss' reached 0.03954 (best 0.03954), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
[2024-04-12 16:51:47,704][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 1157: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.039
[2024-04-12 16:52:29,150][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 1246: 'val_loss' reached 0.03891 (best 0.03891), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.036
[2024-04-12 16:53:10,510][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 1335: 'val_loss' reached 0.03648 (best 0.03648), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
[2024-04-12 16:53:52,080][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 1424: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.034
[2024-04-12 16:54:33,074][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 1513: 'val_loss' reached 0.03434 (best 0.03434), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
[2024-04-12 16:55:14,285][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 1602: 'val_loss' was not in top 1
[2024-04-12 16:55:55,546][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 1691: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.034
[2024-04-12 16:56:36,891][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 1780: 'val_loss' reached 0.03424 (best 0.03424), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
[2024-04-12 16:57:18,125][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 1869: 'val_loss' was not in top 1
[2024-04-12 16:57:59,469][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 1958: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.034
[2024-04-12 16:58:40,954][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 2047: 'val_loss' reached 0.03368 (best 0.03368), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
[2024-04-12 16:59:22,214][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 2136: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.033
[2024-04-12 17:00:03,600][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 2225: 'val_loss' reached 0.03342 (best 0.03342), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.032
[2024-04-12 17:00:44,376][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 2314: 'val_loss' reached 0.03200 (best 0.03200), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.030
[2024-04-12 17:01:26,522][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 2403: 'val_loss' reached 0.03045 (best 0.03045), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
[2024-04-12 17:02:07,537][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 2492: 'val_loss' was not in top 1
[2024-04-12 17:02:49,321][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 2581: 'val_loss' was not in top 1
[2024-04-12 17:03:30,328][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 2670: 'val_loss' was not in top 1
[2024-04-12 17:04:11,533][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 2759: 'val_loss' was not in top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.025
[2024-04-12 17:04:53,067][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 2848: 'val_loss' reached 0.02527 (best 0.02527), saving model to '/tmp/tmpjo_skoy1/model_0.ckpt' as top 1
[2024-04-12 17:05:34,170][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 2937: 'val_loss' was not in top 1
[2024-04-12 17:06:15,079][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 3026: 'val_loss' was not in top 1
[2024-04-12 17:06:56,590][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 3115: 'val_loss' was not in top 1
[2024-04-12 17:07:38,086][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 3204: 'val_loss' was not in top 1
[2024-04-12 17:08:19,026][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 3293: 'val_loss' was not in top 1
[2024-04-12 17:09:00,098][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 3382: 'val_loss' was not in top 1
[2024-04-12 17:09:41,057][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 3471: 'val_loss' was not in top 1
[2024-04-12 17:10:22,703][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 3560: 'val_loss' was not in top 1
[2024-04-12 17:11:04,300][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 3649: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.025. Signaling Trainer to stop.
[2024-04-12 17:11:45,198][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 3738: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
2024/04/12 17:11:48 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/12 17:11:48 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/12 17:11:48 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/12 17:11:48 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-12 17:11:48,418][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-12 17:11:48,418][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-12 17:11:48,418][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-12 17:11:48,418][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/12 17:11:48 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpjo_skoy1 exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.087
[2024-04-12 17:12:34,196][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 89: 'val_loss' reached 0.08670 (best 0.08670), saving model to '/tmp/tmpjo_skoy1/model_1.ckpt' as top 1
Metric val_loss improved by 0.015 >= min_delta = 1e-05. New best score: 0.072
[2024-04-12 17:13:15,454][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 178: 'val_loss' reached 0.07202 (best 0.07202), saving model to '/tmp/tmpjo_skoy1/model_1.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.071
[2024-04-12 17:13:56,519][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 267: 'val_loss' reached 0.07128 (best 0.07128), saving model to '/tmp/tmpjo_skoy1/model_1.ckpt' as top 1
[2024-04-12 17:14:37,676][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 356: 'val_loss' was not in top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.063
[2024-04-12 17:15:18,667][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 445: 'val_loss' reached 0.06259 (best 0.06259), saving model to '/tmp/tmpjo_skoy1/model_1.ckpt' as top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.055
[2024-04-12 17:15:59,909][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 534: 'val_loss' reached 0.05452 (best 0.05452), saving model to '/tmp/tmpjo_skoy1/model_1.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.053
[2024-04-12 17:16:41,484][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 623: 'val_loss' reached 0.05269 (best 0.05269), saving model to '/tmp/tmpjo_skoy1/model_1.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.048
[2024-04-12 17:17:22,457][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 712: 'val_loss' reached 0.04846 (best 0.04846), saving model to '/tmp/tmpjo_skoy1/model_1.ckpt' as top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.040
[2024-04-12 17:18:02,967][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 801: 'val_loss' reached 0.03997 (best 0.03997), saving model to '/tmp/tmpjo_skoy1/model_1.ckpt' as top 1
[2024-04-12 17:18:44,407][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 890: 'val_loss' was not in top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.035
[2024-04-12 17:19:25,073][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 979: 'val_loss' reached 0.03498 (best 0.03498), saving model to '/tmp/tmpjo_skoy1/model_1.ckpt' as top 1
[2024-04-12 17:20:05,743][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 1068: 'val_loss' was not in top 1
[2024-04-12 17:20:46,788][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 1157: 'val_loss' was not in top 1
[2024-04-12 17:21:27,368][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 1246: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.034
[2024-04-12 17:22:09,233][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 1335: 'val_loss' reached 0.03387 (best 0.03387), saving model to '/tmp/tmpjo_skoy1/model_1.ckpt' as top 1
[2024-04-12 17:22:50,633][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 1424: 'val_loss' was not in top 1
[2024-04-12 17:23:31,713][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 1513: 'val_loss' was not in top 1
[2024-04-12 17:24:12,660][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 1602: 'val_loss' was not in top 1
[2024-04-12 17:24:53,133][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 1691: 'val_loss' was not in top 1
[2024-04-12 17:25:34,247][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 1780: 'val_loss' was not in top 1
[2024-04-12 17:26:15,063][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 1869: 'val_loss' was not in top 1
[2024-04-12 17:26:56,127][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 1958: 'val_loss' was not in top 1
[2024-04-12 17:27:37,306][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 2047: 'val_loss' was not in top 1
[2024-04-12 17:28:18,801][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 2136: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.034. Signaling Trainer to stop.
[2024-04-12 17:29:00,078][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 2225: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/12 17:29:02 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/12 17:29:02 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/12 17:29:02 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/12 17:29:02 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-12 17:29:02,802][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-12 17:29:02,802][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-12 17:29:02,802][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-12 17:29:02,802][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/12 17:29:02 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpjo_skoy1 exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.086
[2024-04-12 17:29:48,997][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 89: 'val_loss' reached 0.08568 (best 0.08568), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
Metric val_loss improved by 0.026 >= min_delta = 1e-05. New best score: 0.060
[2024-04-12 17:30:30,288][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 178: 'val_loss' reached 0.05969 (best 0.05969), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
[2024-04-12 17:31:11,461][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 267: 'val_loss' was not in top 1
[2024-04-12 17:31:52,264][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 356: 'val_loss' was not in top 1
[2024-04-12 17:32:33,071][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 445: 'val_loss' was not in top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.050
[2024-04-12 17:33:14,139][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 534: 'val_loss' reached 0.05023 (best 0.05023), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.048
[2024-04-12 17:33:55,495][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 623: 'val_loss' reached 0.04760 (best 0.04760), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
[2024-04-12 17:34:36,768][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 712: 'val_loss' was not in top 1
[2024-04-12 17:35:17,893][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 801: 'val_loss' was not in top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.039
[2024-04-12 17:35:58,714][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 890: 'val_loss' reached 0.03896 (best 0.03896), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.038
[2024-04-12 17:36:39,751][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 979: 'val_loss' reached 0.03798 (best 0.03798), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.033
[2024-04-12 17:37:20,948][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 1068: 'val_loss' reached 0.03339 (best 0.03339), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
[2024-04-12 17:38:01,826][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 1157: 'val_loss' was not in top 1
[2024-04-12 17:38:43,416][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 1246: 'val_loss' was not in top 1
[2024-04-12 17:39:24,061][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 1335: 'val_loss' was not in top 1
[2024-04-12 17:40:05,099][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 1424: 'val_loss' was not in top 1
[2024-04-12 17:40:45,936][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 1513: 'val_loss' was not in top 1
[2024-04-12 17:41:27,081][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 1602: 'val_loss' was not in top 1
[2024-04-12 17:42:08,148][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 1691: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.033
[2024-04-12 17:42:49,053][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 1780: 'val_loss' reached 0.03276 (best 0.03276), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
[2024-04-12 17:43:30,422][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 1869: 'val_loss' was not in top 1
[2024-04-12 17:44:11,713][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 1958: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.032
[2024-04-12 17:44:52,085][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 2047: 'val_loss' reached 0.03223 (best 0.03223), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.029
[2024-04-12 17:45:32,905][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 2136: 'val_loss' reached 0.02911 (best 0.02911), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
[2024-04-12 17:46:14,284][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 2225: 'val_loss' was not in top 1
[2024-04-12 17:46:56,168][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 2314: 'val_loss' was not in top 1
[2024-04-12 17:47:37,338][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 2403: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.027
[2024-04-12 17:48:19,106][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 2492: 'val_loss' reached 0.02734 (best 0.02734), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
[2024-04-12 17:49:00,186][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 2581: 'val_loss' was not in top 1
[2024-04-12 17:49:41,297][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 2670: 'val_loss' was not in top 1
[2024-04-12 17:50:22,344][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 2759: 'val_loss' was not in top 1
[2024-04-12 17:51:02,812][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 2848: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.026
[2024-04-12 17:51:43,750][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 2937: 'val_loss' reached 0.02620 (best 0.02620), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
[2024-04-12 17:52:24,199][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 3026: 'val_loss' was not in top 1
[2024-04-12 17:53:05,289][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 3115: 'val_loss' was not in top 1
[2024-04-12 17:53:46,264][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 3204: 'val_loss' was not in top 1
[2024-04-12 17:54:27,201][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 3293: 'val_loss' was not in top 1
[2024-04-12 17:55:08,454][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 3382: 'val_loss' was not in top 1
[2024-04-12 17:55:50,013][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 3471: 'val_loss' was not in top 1
[2024-04-12 17:56:31,132][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 3560: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.026
[2024-04-12 17:57:12,100][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 3649: 'val_loss' reached 0.02593 (best 0.02593), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
[2024-04-12 17:57:52,981][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 3738: 'val_loss' was not in top 1
[2024-04-12 17:58:33,697][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 3827: 'val_loss' was not in top 1
[2024-04-12 17:59:14,911][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 3916: 'val_loss' was not in top 1
[2024-04-12 17:59:56,376][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 4005: 'val_loss' was not in top 1
[2024-04-12 18:00:37,202][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 4094: 'val_loss' was not in top 1
[2024-04-12 18:01:18,159][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 4183: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.024
[2024-04-12 18:01:59,627][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 4272: 'val_loss' reached 0.02416 (best 0.02416), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
[2024-04-12 18:02:41,249][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 4361: 'val_loss' was not in top 1
[2024-04-12 18:03:22,098][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 4450: 'val_loss' was not in top 1
[2024-04-12 18:04:02,824][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 50, global step 4539: 'val_loss' was not in top 1
[2024-04-12 18:04:44,794][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 51, global step 4628: 'val_loss' was not in top 1
[2024-04-12 18:05:26,319][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 52, global step 4717: 'val_loss' was not in top 1
[2024-04-12 18:06:07,500][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 53, global step 4806: 'val_loss' was not in top 1
[2024-04-12 18:06:49,405][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 54, global step 4895: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.024
[2024-04-12 18:07:30,902][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 55, global step 4984: 'val_loss' reached 0.02400 (best 0.02400), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
[2024-04-12 18:08:11,346][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 56, global step 5073: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.023
[2024-04-12 18:08:53,106][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 57, global step 5162: 'val_loss' reached 0.02341 (best 0.02341), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
[2024-04-12 18:09:34,326][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 58, global step 5251: 'val_loss' was not in top 1
[2024-04-12 18:10:15,726][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 59, global step 5340: 'val_loss' was not in top 1
[2024-04-12 18:10:57,634][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 60, global step 5429: 'val_loss' was not in top 1
[2024-04-12 18:11:38,822][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 61, global step 5518: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.021
[2024-04-12 18:12:19,887][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 62, global step 5607: 'val_loss' reached 0.02091 (best 0.02091), saving model to '/tmp/tmpjo_skoy1/model_2.ckpt' as top 1
[2024-04-12 18:13:01,571][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 63, global step 5696: 'val_loss' was not in top 1
[2024-04-12 18:13:42,663][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 64, global step 5785: 'val_loss' was not in top 1
[2024-04-12 18:14:23,529][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 65, global step 5874: 'val_loss' was not in top 1
[2024-04-12 18:15:04,464][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 66, global step 5963: 'val_loss' was not in top 1
[2024-04-12 18:15:45,798][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 67, global step 6052: 'val_loss' was not in top 1
[2024-04-12 18:16:26,493][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 68, global step 6141: 'val_loss' was not in top 1
[2024-04-12 18:17:07,741][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 69, global step 6230: 'val_loss' was not in top 1
[2024-04-12 18:17:49,092][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 70, global step 6319: 'val_loss' was not in top 1
[2024-04-12 18:18:30,334][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 71, global step 6408: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.021. Signaling Trainer to stop.
[2024-04-12 18:19:12,158][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 72, global step 6497: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/12 18:19:14 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/12 18:19:14 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/12 18:19:14 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/12 18:19:14 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-12 18:19:14,865][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-12 18:19:14,865][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-12 18:19:14,865][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-12 18:19:14,865][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/12 18:19:14 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpjo_skoy1 exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.076
[2024-04-12 18:20:00,406][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 89: 'val_loss' reached 0.07602 (best 0.07602), saving model to '/tmp/tmpjo_skoy1/model_3.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.074
[2024-04-12 18:20:41,808][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 178: 'val_loss' reached 0.07392 (best 0.07392), saving model to '/tmp/tmpjo_skoy1/model_3.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.071
[2024-04-12 18:21:23,116][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 267: 'val_loss' reached 0.07071 (best 0.07071), saving model to '/tmp/tmpjo_skoy1/model_3.ckpt' as top 1
Metric val_loss improved by 0.007 >= min_delta = 1e-05. New best score: 0.063
[2024-04-12 18:22:04,582][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 356: 'val_loss' reached 0.06331 (best 0.06331), saving model to '/tmp/tmpjo_skoy1/model_3.ckpt' as top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.054
[2024-04-12 18:22:45,988][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 445: 'val_loss' reached 0.05432 (best 0.05432), saving model to '/tmp/tmpjo_skoy1/model_3.ckpt' as top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.046
[2024-04-12 18:23:27,467][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 534: 'val_loss' reached 0.04610 (best 0.04610), saving model to '/tmp/tmpjo_skoy1/model_3.ckpt' as top 1
[2024-04-12 18:24:09,308][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 623: 'val_loss' was not in top 1
[2024-04-12 18:24:50,282][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 712: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.046
[2024-04-12 18:25:31,354][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 801: 'val_loss' reached 0.04594 (best 0.04594), saving model to '/tmp/tmpjo_skoy1/model_3.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.045
[2024-04-12 18:26:12,361][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 890: 'val_loss' reached 0.04511 (best 0.04511), saving model to '/tmp/tmpjo_skoy1/model_3.ckpt' as top 1
[2024-04-12 18:26:54,471][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 979: 'val_loss' was not in top 1
[2024-04-12 18:27:35,849][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 1068: 'val_loss' was not in top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.037
[2024-04-12 18:28:16,702][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 1157: 'val_loss' reached 0.03731 (best 0.03731), saving model to '/tmp/tmpjo_skoy1/model_3.ckpt' as top 1
[2024-04-12 18:28:58,085][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 1246: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.035
[2024-04-12 18:29:39,285][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 1335: 'val_loss' reached 0.03463 (best 0.03463), saving model to '/tmp/tmpjo_skoy1/model_3.ckpt' as top 1
[2024-04-12 18:30:19,927][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 1424: 'val_loss' was not in top 1
[2024-04-12 18:31:01,274][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 1513: 'val_loss' was not in top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.029
[2024-04-12 18:31:42,928][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 1602: 'val_loss' reached 0.02909 (best 0.02909), saving model to '/tmp/tmpjo_skoy1/model_3.ckpt' as top 1
[2024-04-12 18:32:24,323][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 1691: 'val_loss' was not in top 1
[2024-04-12 18:33:04,878][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 1780: 'val_loss' was not in top 1
[2024-04-12 18:33:46,161][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 1869: 'val_loss' was not in top 1
[2024-04-12 18:34:27,383][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 1958: 'val_loss' was not in top 1
[2024-04-12 18:35:08,670][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 2047: 'val_loss' was not in top 1
[2024-04-12 18:35:50,335][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 2136: 'val_loss' was not in top 1
[2024-04-12 18:36:30,927][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 2225: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.028
[2024-04-12 18:37:11,295][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 2314: 'val_loss' reached 0.02823 (best 0.02823), saving model to '/tmp/tmpjo_skoy1/model_3.ckpt' as top 1
[2024-04-12 18:37:52,949][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 2403: 'val_loss' was not in top 1
[2024-04-12 18:38:34,790][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 2492: 'val_loss' was not in top 1
[2024-04-12 18:39:14,982][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 2581: 'val_loss' was not in top 1
[2024-04-12 18:39:56,688][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 2670: 'val_loss' was not in top 1
[2024-04-12 18:40:37,841][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 2759: 'val_loss' was not in top 1
[2024-04-12 18:41:19,581][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 2848: 'val_loss' was not in top 1
[2024-04-12 18:42:00,748][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 2937: 'val_loss' was not in top 1
[2024-04-12 18:42:42,291][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 3026: 'val_loss' was not in top 1
[2024-04-12 18:43:23,125][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 3115: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.028. Signaling Trainer to stop.
[2024-04-12 18:44:04,126][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 3204: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/12 18:44:06 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/12 18:44:06 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/12 18:44:06 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/12 18:44:06 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-12 18:44:06,860][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-12 18:44:06,860][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-12 18:44:06,860][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-12 18:44:06,861][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/12 18:44:06 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpjo_skoy1 exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.078
[2024-04-12 18:44:53,670][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 89: 'val_loss' reached 0.07830 (best 0.07830), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.013 >= min_delta = 1e-05. New best score: 0.066
[2024-04-12 18:45:34,859][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 178: 'val_loss' reached 0.06568 (best 0.06568), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.062
[2024-04-12 18:46:16,339][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 267: 'val_loss' reached 0.06229 (best 0.06229), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.058
[2024-04-12 18:46:57,992][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 356: 'val_loss' reached 0.05762 (best 0.05762), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.054
[2024-04-12 18:47:38,852][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 445: 'val_loss' reached 0.05417 (best 0.05417), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.053
[2024-04-12 18:48:20,061][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 534: 'val_loss' reached 0.05321 (best 0.05321), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.052
[2024-04-12 18:49:01,626][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 623: 'val_loss' reached 0.05159 (best 0.05159), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.052
[2024-04-12 18:49:42,924][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 712: 'val_loss' reached 0.05154 (best 0.05154), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.046
[2024-04-12 18:50:24,037][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 801: 'val_loss' reached 0.04634 (best 0.04634), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.045
[2024-04-12 18:51:04,979][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 890: 'val_loss' reached 0.04481 (best 0.04481), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.042
[2024-04-12 18:51:46,580][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 979: 'val_loss' reached 0.04163 (best 0.04163), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.041
[2024-04-12 18:52:28,187][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 1068: 'val_loss' reached 0.04127 (best 0.04127), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.037
[2024-04-12 18:53:09,311][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 1157: 'val_loss' reached 0.03744 (best 0.03744), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
[2024-04-12 18:53:50,751][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 1246: 'val_loss' was not in top 1
[2024-04-12 18:54:32,590][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 1335: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.034
[2024-04-12 18:55:13,254][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 1424: 'val_loss' reached 0.03375 (best 0.03375), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
[2024-04-12 18:55:54,275][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 1513: 'val_loss' was not in top 1
[2024-04-12 18:56:35,462][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 1602: 'val_loss' was not in top 1
[2024-04-12 18:57:16,770][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 1691: 'val_loss' was not in top 1
[2024-04-12 18:57:58,112][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 1780: 'val_loss' was not in top 1
[2024-04-12 18:58:40,353][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 1869: 'val_loss' was not in top 1
[2024-04-12 18:59:22,103][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 1958: 'val_loss' was not in top 1
[2024-04-12 19:00:03,049][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 2047: 'val_loss' was not in top 1
[2024-04-12 19:00:44,308][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 2136: 'val_loss' was not in top 1
[2024-04-12 19:01:25,296][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 2225: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.032
[2024-04-12 19:02:05,893][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 2314: 'val_loss' reached 0.03213 (best 0.03213), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.031
[2024-04-12 19:02:47,201][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 2403: 'val_loss' reached 0.03064 (best 0.03064), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
[2024-04-12 19:03:28,085][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 2492: 'val_loss' was not in top 1
[2024-04-12 19:04:09,028][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 2581: 'val_loss' was not in top 1
[2024-04-12 19:04:50,142][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 2670: 'val_loss' was not in top 1
[2024-04-12 19:05:31,390][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 2759: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.028
[2024-04-12 19:06:12,788][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 2848: 'val_loss' reached 0.02837 (best 0.02837), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
[2024-04-12 19:06:54,029][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 2937: 'val_loss' was not in top 1
[2024-04-12 19:07:35,757][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 3026: 'val_loss' was not in top 1
[2024-04-12 19:08:17,496][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 3115: 'val_loss' was not in top 1
[2024-04-12 19:08:59,016][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 3204: 'val_loss' was not in top 1
[2024-04-12 19:09:40,384][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 3293: 'val_loss' was not in top 1
[2024-04-12 19:10:21,680][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 3382: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.027
[2024-04-12 19:11:02,516][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 3471: 'val_loss' reached 0.02724 (best 0.02724), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
[2024-04-12 19:11:43,406][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 3560: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.026
[2024-04-12 19:12:24,279][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 3649: 'val_loss' reached 0.02611 (best 0.02611), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
[2024-04-12 19:13:05,151][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 3738: 'val_loss' was not in top 1
[2024-04-12 19:13:45,820][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 3827: 'val_loss' was not in top 1
[2024-04-12 19:14:26,996][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 3916: 'val_loss' was not in top 1
[2024-04-12 19:15:08,346][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 4005: 'val_loss' was not in top 1
[2024-04-12 19:15:49,937][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 4094: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.026
[2024-04-12 19:16:31,593][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 4183: 'val_loss' reached 0.02605 (best 0.02605), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.025
[2024-04-12 19:17:13,302][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 4272: 'val_loss' reached 0.02527 (best 0.02527), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
[2024-04-12 19:17:55,042][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 4361: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.023
[2024-04-12 19:18:35,678][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 4450: 'val_loss' reached 0.02331 (best 0.02331), saving model to '/tmp/tmpjo_skoy1/model_4.ckpt' as top 1
[2024-04-12 19:19:16,606][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 50, global step 4539: 'val_loss' was not in top 1
[2024-04-12 19:19:56,531][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 51, global step 4628: 'val_loss' was not in top 1
[2024-04-12 19:20:37,561][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 52, global step 4717: 'val_loss' was not in top 1
[2024-04-12 19:21:18,502][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 53, global step 4806: 'val_loss' was not in top 1
[2024-04-12 19:21:59,650][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 54, global step 4895: 'val_loss' was not in top 1
[2024-04-12 19:22:40,808][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 55, global step 4984: 'val_loss' was not in top 1
[2024-04-12 19:23:21,900][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 56, global step 5073: 'val_loss' was not in top 1
[2024-04-12 19:24:03,140][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 57, global step 5162: 'val_loss' was not in top 1
[2024-04-12 19:24:44,820][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 58, global step 5251: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.023. Signaling Trainer to stop.
[2024-04-12 19:25:25,508][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 59, global step 5340: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/12 19:25:28 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/12 19:25:28 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/12 19:25:28 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/12 19:25:28 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-12 19:25:28,256][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-12 19:25:28,256][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-12 19:25:28,256][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-12 19:25:28,256][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/12 19:25:28 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpjo_skoy1 exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.093
[2024-04-12 19:26:14,343][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 89: 'val_loss' reached 0.09331 (best 0.09331), saving model to '/tmp/tmpjo_skoy1/model_5.ckpt' as top 1
Metric val_loss improved by 0.014 >= min_delta = 1e-05. New best score: 0.080
[2024-04-12 19:26:55,369][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 178: 'val_loss' reached 0.07960 (best 0.07960), saving model to '/tmp/tmpjo_skoy1/model_5.ckpt' as top 1
Metric val_loss improved by 0.018 >= min_delta = 1e-05. New best score: 0.062
[2024-04-12 19:27:37,200][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 267: 'val_loss' reached 0.06205 (best 0.06205), saving model to '/tmp/tmpjo_skoy1/model_5.ckpt' as top 1
[2024-04-12 19:28:18,031][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 356: 'val_loss' was not in top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.057
[2024-04-12 19:28:58,816][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 445: 'val_loss' reached 0.05656 (best 0.05656), saving model to '/tmp/tmpjo_skoy1/model_5.ckpt' as top 1
Metric val_loss improved by 0.011 >= min_delta = 1e-05. New best score: 0.046
[2024-04-12 19:29:40,273][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 534: 'val_loss' reached 0.04601 (best 0.04601), saving model to '/tmp/tmpjo_skoy1/model_5.ckpt' as top 1
[2024-04-12 19:30:21,554][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 623: 'val_loss' was not in top 1
[2024-04-12 19:31:03,173][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 712: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.044
[2024-04-12 19:31:44,380][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 801: 'val_loss' reached 0.04383 (best 0.04383), saving model to '/tmp/tmpjo_skoy1/model_5.ckpt' as top 1
[2024-04-12 19:32:25,957][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 890: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.042
[2024-04-12 19:33:07,434][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 979: 'val_loss' reached 0.04225 (best 0.04225), saving model to '/tmp/tmpjo_skoy1/model_5.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.041
[2024-04-12 19:33:49,321][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 1068: 'val_loss' reached 0.04078 (best 0.04078), saving model to '/tmp/tmpjo_skoy1/model_5.ckpt' as top 1
[2024-04-12 19:34:31,520][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 1157: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.039
[2024-04-12 19:35:12,545][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 1246: 'val_loss' reached 0.03896 (best 0.03896), saving model to '/tmp/tmpjo_skoy1/model_5.ckpt' as top 1
[2024-04-12 19:35:54,258][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 1335: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.036
[2024-04-12 19:36:35,384][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 1424: 'val_loss' reached 0.03639 (best 0.03639), saving model to '/tmp/tmpjo_skoy1/model_5.ckpt' as top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.032
[2024-04-12 19:37:17,123][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 1513: 'val_loss' reached 0.03158 (best 0.03158), saving model to '/tmp/tmpjo_skoy1/model_5.ckpt' as top 1
[2024-04-12 19:37:58,477][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 1602: 'val_loss' was not in top 1
[2024-04-12 19:38:39,811][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 1691: 'val_loss' was not in top 1
[2024-04-12 19:39:21,302][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 1780: 'val_loss' was not in top 1
[2024-04-12 19:40:02,472][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 1869: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.030
[2024-04-12 19:40:43,973][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 1958: 'val_loss' reached 0.02981 (best 0.02981), saving model to '/tmp/tmpjo_skoy1/model_5.ckpt' as top 1
[2024-04-12 19:41:25,321][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 2047: 'val_loss' was not in top 1
[2024-04-12 19:42:07,100][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 2136: 'val_loss' was not in top 1
[2024-04-12 19:42:49,096][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 2225: 'val_loss' was not in top 1
[2024-04-12 19:43:30,611][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 2314: 'val_loss' was not in top 1
[2024-04-12 19:44:12,008][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 2403: 'val_loss' was not in top 1
[2024-04-12 19:44:53,736][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 2492: 'val_loss' was not in top 1
[2024-04-12 19:45:34,692][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 2581: 'val_loss' was not in top 1
[2024-04-12 19:46:15,859][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 2670: 'val_loss' was not in top 1
[2024-04-12 19:46:57,177][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 2759: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.030. Signaling Trainer to stop.
[2024-04-12 19:47:38,650][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 2848: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/12 19:47:41 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/12 19:47:41 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/12 19:47:41 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/12 19:47:41 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-12 19:47:41,496][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-12 19:47:41,496][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-12 19:47:41,496][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-12 19:47:41,496][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/12 19:47:41 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpjo_skoy1 exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.084
[2024-04-12 19:48:26,005][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 89: 'val_loss' reached 0.08449 (best 0.08449), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
Metric val_loss improved by 0.016 >= min_delta = 1e-05. New best score: 0.068
[2024-04-12 19:49:05,083][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 178: 'val_loss' reached 0.06819 (best 0.06819), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
[2024-04-12 19:49:43,717][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 267: 'val_loss' was not in top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.062
[2024-04-12 19:50:22,982][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 356: 'val_loss' reached 0.06199 (best 0.06199), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.058
[2024-04-12 19:51:01,840][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 445: 'val_loss' reached 0.05812 (best 0.05812), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.049
[2024-04-12 19:51:41,079][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 534: 'val_loss' reached 0.04928 (best 0.04928), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
[2024-04-12 19:52:20,418][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 623: 'val_loss' was not in top 1
[2024-04-12 19:52:59,578][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 712: 'val_loss' was not in top 1
[2024-04-12 19:53:39,127][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 801: 'val_loss' was not in top 1
[2024-04-12 19:54:18,349][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 890: 'val_loss' was not in top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.042
[2024-04-12 19:54:57,425][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 979: 'val_loss' reached 0.04156 (best 0.04156), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
[2024-04-12 19:55:36,743][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 1068: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.039
[2024-04-12 19:56:16,208][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 1157: 'val_loss' reached 0.03881 (best 0.03881), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
[2024-04-12 19:56:56,080][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 1246: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.039
[2024-04-12 19:57:35,417][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 1335: 'val_loss' reached 0.03870 (best 0.03870), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
[2024-04-12 19:58:15,118][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 1424: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.037
[2024-04-12 19:58:55,082][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 1513: 'val_loss' reached 0.03723 (best 0.03723), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.037
[2024-04-12 19:59:34,661][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 1602: 'val_loss' reached 0.03698 (best 0.03698), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.033
[2024-04-12 20:00:14,387][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 1691: 'val_loss' reached 0.03344 (best 0.03344), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
[2024-04-12 20:00:54,171][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 1780: 'val_loss' was not in top 1
[2024-04-12 20:01:33,909][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 1869: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.031
[2024-04-12 20:02:12,791][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 1958: 'val_loss' reached 0.03061 (best 0.03061), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
[2024-04-12 20:02:51,865][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 2047: 'val_loss' was not in top 1
[2024-04-12 20:03:30,465][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 2136: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.030
[2024-04-12 20:04:09,909][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 2225: 'val_loss' reached 0.03028 (best 0.03028), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
[2024-04-12 20:04:49,341][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 2314: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.029
[2024-04-12 20:05:28,956][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 2403: 'val_loss' reached 0.02928 (best 0.02928), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.029
[2024-04-12 20:06:08,252][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 2492: 'val_loss' reached 0.02888 (best 0.02888), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
[2024-04-12 20:06:47,609][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 2581: 'val_loss' was not in top 1
[2024-04-12 20:07:26,573][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 2670: 'val_loss' was not in top 1
[2024-04-12 20:08:05,580][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 2759: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.029
[2024-04-12 20:08:44,244][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 2848: 'val_loss' reached 0.02869 (best 0.02869), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
[2024-04-12 20:09:23,371][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 2937: 'val_loss' was not in top 1
[2024-04-12 20:10:02,304][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 3026: 'val_loss' was not in top 1
[2024-04-12 20:10:41,189][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 3115: 'val_loss' was not in top 1
[2024-04-12 20:11:20,046][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 3204: 'val_loss' was not in top 1
Metric val_loss improved by 0.005 >= min_delta = 1e-05. New best score: 0.023
[2024-04-12 20:11:58,575][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 3293: 'val_loss' reached 0.02345 (best 0.02345), saving model to '/tmp/tmpjo_skoy1/model_6.ckpt' as top 1
[2024-04-12 20:12:37,958][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 3382: 'val_loss' was not in top 1
[2024-04-12 20:13:16,844][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 3471: 'val_loss' was not in top 1
[2024-04-12 20:13:55,801][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 3560: 'val_loss' was not in top 1
[2024-04-12 20:14:34,812][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 3649: 'val_loss' was not in top 1
[2024-04-12 20:15:14,166][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 3738: 'val_loss' was not in top 1
[2024-04-12 20:15:52,577][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 3827: 'val_loss' was not in top 1
[2024-04-12 20:16:31,892][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 3916: 'val_loss' was not in top 1
[2024-04-12 20:17:11,090][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 4005: 'val_loss' was not in top 1
[2024-04-12 20:17:50,141][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 4094: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.023. Signaling Trainer to stop.
[2024-04-12 20:18:29,147][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 4183: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/12 20:18:31 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/12 20:18:31 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/12 20:18:31 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/12 20:18:31 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-12 20:18:31,857][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-12 20:18:31,857][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-12 20:18:31,857][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-12 20:18:31,857][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/12 20:18:31 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpjo_skoy1 exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.087
[2024-04-12 20:19:16,103][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 89: 'val_loss' reached 0.08660 (best 0.08660), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
Metric val_loss improved by 0.017 >= min_delta = 1e-05. New best score: 0.070
[2024-04-12 20:19:55,588][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 178: 'val_loss' reached 0.06985 (best 0.06985), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.068
[2024-04-12 20:20:34,649][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 267: 'val_loss' reached 0.06833 (best 0.06833), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
[2024-04-12 20:21:14,114][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 356: 'val_loss' was not in top 1
Metric val_loss improved by 0.011 >= min_delta = 1e-05. New best score: 0.057
[2024-04-12 20:21:53,353][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 445: 'val_loss' reached 0.05748 (best 0.05748), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
[2024-04-12 20:22:32,170][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 534: 'val_loss' was not in top 1
Metric val_loss improved by 0.010 >= min_delta = 1e-05. New best score: 0.048
[2024-04-12 20:23:11,046][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 623: 'val_loss' reached 0.04763 (best 0.04763), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
[2024-04-12 20:23:50,076][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 712: 'val_loss' was not in top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.043
[2024-04-12 20:24:29,094][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 801: 'val_loss' reached 0.04313 (best 0.04313), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.043
[2024-04-12 20:25:08,673][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 890: 'val_loss' reached 0.04281 (best 0.04281), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.041
[2024-04-12 20:25:48,246][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 979: 'val_loss' reached 0.04148 (best 0.04148), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
Metric val_loss improved by 0.004 >= min_delta = 1e-05. New best score: 0.038
[2024-04-12 20:26:27,395][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 1068: 'val_loss' reached 0.03778 (best 0.03778), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
[2024-04-12 20:27:06,927][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 1157: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.036
[2024-04-12 20:27:45,620][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 1246: 'val_loss' reached 0.03616 (best 0.03616), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
[2024-04-12 20:28:24,717][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 1335: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.033
[2024-04-12 20:29:03,166][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 1424: 'val_loss' reached 0.03335 (best 0.03335), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
[2024-04-12 20:29:41,987][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 1513: 'val_loss' was not in top 1
[2024-04-12 20:30:20,975][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 1602: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.032
[2024-04-12 20:31:00,329][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 1691: 'val_loss' reached 0.03242 (best 0.03242), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
[2024-04-12 20:31:39,725][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 1780: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.031
[2024-04-12 20:32:18,360][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 1869: 'val_loss' reached 0.03072 (best 0.03072), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
[2024-04-12 20:32:57,827][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 1958: 'val_loss' was not in top 1
[2024-04-12 20:33:36,595][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 2047: 'val_loss' was not in top 1
[2024-04-12 20:34:15,654][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 2136: 'val_loss' was not in top 1
[2024-04-12 20:34:54,361][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 2225: 'val_loss' was not in top 1
[2024-04-12 20:35:33,465][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 2314: 'val_loss' was not in top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.028
[2024-04-12 20:36:12,620][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 2403: 'val_loss' reached 0.02841 (best 0.02841), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
[2024-04-12 20:36:51,928][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 2492: 'val_loss' was not in top 1
[2024-04-12 20:37:31,219][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 2581: 'val_loss' was not in top 1
[2024-04-12 20:38:10,336][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 2670: 'val_loss' was not in top 1
[2024-04-12 20:38:48,794][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 2759: 'val_loss' was not in top 1
[2024-04-12 20:39:27,349][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 2848: 'val_loss' was not in top 1
[2024-04-12 20:40:06,672][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 2937: 'val_loss' was not in top 1
[2024-04-12 20:40:45,855][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 33, global step 3026: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.028
[2024-04-12 20:41:24,778][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 34, global step 3115: 'val_loss' reached 0.02823 (best 0.02823), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
[2024-04-12 20:42:03,992][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 35, global step 3204: 'val_loss' was not in top 1
[2024-04-12 20:42:43,222][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 36, global step 3293: 'val_loss' was not in top 1
[2024-04-12 20:43:22,083][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 37, global step 3382: 'val_loss' was not in top 1
[2024-04-12 20:44:01,468][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 38, global step 3471: 'val_loss' was not in top 1
[2024-04-12 20:44:40,293][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 39, global step 3560: 'val_loss' was not in top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.028
[2024-04-12 20:45:19,994][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 40, global step 3649: 'val_loss' reached 0.02771 (best 0.02771), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
[2024-04-12 20:45:59,034][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 41, global step 3738: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.024
[2024-04-12 20:46:37,957][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 42, global step 3827: 'val_loss' reached 0.02441 (best 0.02441), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
[2024-04-12 20:47:17,069][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 43, global step 3916: 'val_loss' was not in top 1
[2024-04-12 20:47:55,890][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 44, global step 4005: 'val_loss' was not in top 1
[2024-04-12 20:48:34,836][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 45, global step 4094: 'val_loss' was not in top 1
[2024-04-12 20:49:13,593][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 46, global step 4183: 'val_loss' was not in top 1
[2024-04-12 20:49:52,504][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 47, global step 4272: 'val_loss' was not in top 1
[2024-04-12 20:50:31,538][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 48, global step 4361: 'val_loss' was not in top 1
[2024-04-12 20:51:10,756][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 49, global step 4450: 'val_loss' was not in top 1
[2024-04-12 20:51:49,660][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 50, global step 4539: 'val_loss' was not in top 1
[2024-04-12 20:52:28,671][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 51, global step 4628: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.024
[2024-04-12 20:53:07,649][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 52, global step 4717: 'val_loss' reached 0.02418 (best 0.02418), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.021
[2024-04-12 20:53:47,101][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 53, global step 4806: 'val_loss' reached 0.02146 (best 0.02146), saving model to '/tmp/tmpjo_skoy1/model_7.ckpt' as top 1
[2024-04-12 20:54:26,619][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 54, global step 4895: 'val_loss' was not in top 1
[2024-04-12 20:55:06,081][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 55, global step 4984: 'val_loss' was not in top 1
[2024-04-12 20:55:45,233][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 56, global step 5073: 'val_loss' was not in top 1
[2024-04-12 20:56:24,091][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 57, global step 5162: 'val_loss' was not in top 1
[2024-04-12 20:57:03,651][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 58, global step 5251: 'val_loss' was not in top 1
[2024-04-12 20:57:43,632][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 59, global step 5340: 'val_loss' was not in top 1
[2024-04-12 20:58:23,239][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 60, global step 5429: 'val_loss' was not in top 1
[2024-04-12 20:59:02,627][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 61, global step 5518: 'val_loss' was not in top 1
[2024-04-12 20:59:42,417][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 62, global step 5607: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.021. Signaling Trainer to stop.
[2024-04-12 21:00:21,961][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 63, global step 5696: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/12 21:00:24 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/12 21:00:24 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/12 21:00:24 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/12 21:00:24 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-12 21:00:24,718][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-12 21:00:24,718][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-12 21:00:24,718][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-12 21:00:24,718][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/12 21:00:24 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpjo_skoy1 exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.086
[2024-04-12 21:01:09,257][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 89: 'val_loss' reached 0.08630 (best 0.08630), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.078
[2024-04-12 21:01:48,966][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 178: 'val_loss' reached 0.07767 (best 0.07767), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
Metric val_loss improved by 0.002 >= min_delta = 1e-05. New best score: 0.076
[2024-04-12 21:02:28,247][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 267: 'val_loss' reached 0.07557 (best 0.07557), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.068
[2024-04-12 21:03:06,875][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 356: 'val_loss' reached 0.06753 (best 0.06753), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
Metric val_loss improved by 0.009 >= min_delta = 1e-05. New best score: 0.058
[2024-04-12 21:03:46,223][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 445: 'val_loss' reached 0.05828 (best 0.05828), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.058
[2024-04-12 21:04:25,960][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 534: 'val_loss' reached 0.05768 (best 0.05768), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.051
[2024-04-12 21:05:05,395][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 623: 'val_loss' reached 0.05146 (best 0.05146), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.051
[2024-04-12 21:05:44,920][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 712: 'val_loss' reached 0.05072 (best 0.05072), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
[2024-04-12 21:06:24,402][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 801: 'val_loss' was not in top 1
Metric val_loss improved by 0.008 >= min_delta = 1e-05. New best score: 0.042
[2024-04-12 21:07:03,072][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 890: 'val_loss' reached 0.04236 (best 0.04236), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
[2024-04-12 21:07:42,768][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 979: 'val_loss' was not in top 1
[2024-04-12 21:08:22,274][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 1068: 'val_loss' was not in top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.037
[2024-04-12 21:09:01,545][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 1157: 'val_loss' reached 0.03670 (best 0.03670), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.036
[2024-04-12 21:09:41,277][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 1246: 'val_loss' reached 0.03605 (best 0.03605), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.035
[2024-04-12 21:10:20,514][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 1335: 'val_loss' reached 0.03464 (best 0.03464), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
[2024-04-12 21:10:59,604][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 1424: 'val_loss' was not in top 1
[2024-04-12 21:11:38,999][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 1513: 'val_loss' was not in top 1
[2024-04-12 21:12:17,942][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 1602: 'val_loss' was not in top 1
[2024-04-12 21:12:57,277][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 1691: 'val_loss' was not in top 1
[2024-04-12 21:13:36,861][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 1780: 'val_loss' was not in top 1
Metric val_loss improved by 0.003 >= min_delta = 1e-05. New best score: 0.032
[2024-04-12 21:14:16,512][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 1869: 'val_loss' reached 0.03177 (best 0.03177), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.031
[2024-04-12 21:14:56,545][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 1958: 'val_loss' reached 0.03135 (best 0.03135), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
Metric val_loss improved by 0.001 >= min_delta = 1e-05. New best score: 0.030
[2024-04-12 21:15:35,817][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 2047: 'val_loss' reached 0.03042 (best 0.03042), saving model to '/tmp/tmpjo_skoy1/model_8.ckpt' as top 1
[2024-04-12 21:16:15,174][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 2136: 'val_loss' was not in top 1
[2024-04-12 21:16:54,470][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 2225: 'val_loss' was not in top 1
[2024-04-12 21:17:33,355][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 2314: 'val_loss' was not in top 1
[2024-04-12 21:18:12,476][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 2403: 'val_loss' was not in top 1
[2024-04-12 21:18:51,064][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 2492: 'val_loss' was not in top 1
[2024-04-12 21:19:29,636][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 2581: 'val_loss' was not in top 1
[2024-04-12 21:20:09,327][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 2670: 'val_loss' was not in top 1
[2024-04-12 21:20:48,590][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 2759: 'val_loss' was not in top 1
[2024-04-12 21:21:27,994][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 31, global step 2848: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.030. Signaling Trainer to stop.
[2024-04-12 21:22:07,173][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 32, global step 2937: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/12 21:22:09 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/12 21:22:09 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
2024/04/12 21:22:09 INFO mlflow.system_metrics.system_metrics_monitor: Started monitoring system metrics.
2024/04/12 21:22:09 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of pytorch. If you encounter errors during autologging, try upgrading / downgrading pytorch to a supported version, or try upgrading MLflow.
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
[2024-04-12 21:22:09,918][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
[2024-04-12 21:22:09,918][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-04-12 21:22:09,919][pytorch_lightning.utilities.rank_zero][INFO] - IPU available: False, using: 0 IPUs
[2024-04-12 21:22:09,919][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
2024/04/12 21:22:09 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/mlflow/pytorch/_lightning_autolog.py:463: UserWarning: Autologging is known to be compatible with pytorch-lightning versions between 1.4.9 and 2.2.0.post0 and may not succeed with packages outside this range."
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:653: Checkpoint directory /tmp/tmpjo_skoy1 exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name         | Type       | Params
--------------------------------------------
0 | model        | ResUnetOpt | 0     
1 | criterion    | FocalLoss  | 0     
2 | pred_softmax | Softmax    | 0     
--------------------------------------------
0         Trainable params
0         Non-trainable params
0         Total params
0.000     Total estimated model params size (MB)
Metric val_loss improved. New best score: 0.085
[2024-04-12 21:22:54,587][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 0, global step 89: 'val_loss' reached 0.08517 (best 0.08517), saving model to '/tmp/tmpjo_skoy1/model_9.ckpt' as top 1
Metric val_loss improved by 0.015 >= min_delta = 1e-05. New best score: 0.070
[2024-04-12 21:23:33,027][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 1, global step 178: 'val_loss' reached 0.07050 (best 0.07050), saving model to '/tmp/tmpjo_skoy1/model_9.ckpt' as top 1
Metric val_loss improved by 0.012 >= min_delta = 1e-05. New best score: 0.059
[2024-04-12 21:24:12,906][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 2, global step 267: 'val_loss' reached 0.05895 (best 0.05895), saving model to '/tmp/tmpjo_skoy1/model_9.ckpt' as top 1
[2024-04-12 21:24:52,895][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 3, global step 356: 'val_loss' was not in top 1
[2024-04-12 21:25:32,456][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 4, global step 445: 'val_loss' was not in top 1
Metric val_loss improved by 0.016 >= min_delta = 1e-05. New best score: 0.043
[2024-04-12 21:26:11,810][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 5, global step 534: 'val_loss' reached 0.04306 (best 0.04306), saving model to '/tmp/tmpjo_skoy1/model_9.ckpt' as top 1
[2024-04-12 21:26:51,061][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 6, global step 623: 'val_loss' was not in top 1
[2024-04-12 21:27:30,379][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 7, global step 712: 'val_loss' was not in top 1
[2024-04-12 21:28:09,251][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 8, global step 801: 'val_loss' was not in top 1
[2024-04-12 21:28:48,349][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 9, global step 890: 'val_loss' was not in top 1
[2024-04-12 21:29:27,802][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 10, global step 979: 'val_loss' was not in top 1
[2024-04-12 21:30:07,770][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 11, global step 1068: 'val_loss' was not in top 1
[2024-04-12 21:30:46,971][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 12, global step 1157: 'val_loss' was not in top 1
[2024-04-12 21:31:26,538][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 13, global step 1246: 'val_loss' was not in top 1
Metric val_loss improved by 0.007 >= min_delta = 1e-05. New best score: 0.036
[2024-04-12 21:32:05,959][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 14, global step 1335: 'val_loss' reached 0.03609 (best 0.03609), saving model to '/tmp/tmpjo_skoy1/model_9.ckpt' as top 1
[2024-04-12 21:32:45,215][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 15, global step 1424: 'val_loss' was not in top 1
[2024-04-12 21:33:25,036][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 16, global step 1513: 'val_loss' was not in top 1
[2024-04-12 21:34:05,063][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 17, global step 1602: 'val_loss' was not in top 1
Metric val_loss improved by 0.000 >= min_delta = 1e-05. New best score: 0.036
[2024-04-12 21:34:44,477][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 18, global step 1691: 'val_loss' reached 0.03596 (best 0.03596), saving model to '/tmp/tmpjo_skoy1/model_9.ckpt' as top 1
[2024-04-12 21:35:24,387][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 19, global step 1780: 'val_loss' was not in top 1
Metric val_loss improved by 0.006 >= min_delta = 1e-05. New best score: 0.030
[2024-04-12 21:36:03,844][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 20, global step 1869: 'val_loss' reached 0.03021 (best 0.03021), saving model to '/tmp/tmpjo_skoy1/model_9.ckpt' as top 1
[2024-04-12 21:36:42,980][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 21, global step 1958: 'val_loss' was not in top 1
[2024-04-12 21:37:22,481][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 22, global step 2047: 'val_loss' was not in top 1
[2024-04-12 21:38:01,960][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 23, global step 2136: 'val_loss' was not in top 1
[2024-04-12 21:38:42,093][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 24, global step 2225: 'val_loss' was not in top 1
[2024-04-12 21:39:21,797][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 25, global step 2314: 'val_loss' was not in top 1
[2024-04-12 21:40:00,436][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 26, global step 2403: 'val_loss' was not in top 1
[2024-04-12 21:40:39,421][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 27, global step 2492: 'val_loss' was not in top 1
[2024-04-12 21:41:18,478][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 28, global step 2581: 'val_loss' was not in top 1
[2024-04-12 21:41:57,090][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 29, global step 2670: 'val_loss' was not in top 1
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.030. Signaling Trainer to stop.
[2024-04-12 21:42:37,201][pytorch_lightning.utilities.rank_zero][INFO] - Epoch 30, global step 2759: 'val_loss' was not in top 1
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/torch/nn/modules/lazy.py:181: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:11: UserWarning: Distutils was imported before Setuptools, but importing Setuptools also replaces the `distutils` module in `sys.modules`. This may lead to undesirable behaviors or errors. To avoid these issues, avoid using distutils directly, ensure that setuptools is installed in the traditional way (e.g. not an editable install), and/or make sure that setuptools is always imported before distutils.
  warnings.warn(
/home/felferrari/anaconda3/envs/thesis2/lib/python3.11/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
2024/04/12 21:42:39 INFO mlflow.system_metrics.system_metrics_monitor: Stopping system metrics monitoring...
2024/04/12 21:42:39 INFO mlflow.system_metrics.system_metrics_monitor: Successfully terminated system metrics monitoring!
